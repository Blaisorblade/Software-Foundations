<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>ImpParser: Lexing and Parsing in Coq</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">ImpParser<span class="subtitle">Lexing and Parsing in Coq</span></h1>

<div class="code code-tight">
</div>

<div class="doc">

</div>
<div class="code code-tight">

<br/>
<span class="comment">(*&nbsp;$Date:&nbsp;2011-02-21&nbsp;10:21:18&nbsp;-0500&nbsp;(Mon,&nbsp;21&nbsp;Feb&nbsp;2011)&nbsp;$&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
The development of the <span class="inlinecode"><span class="id" type="var">Imp</span></span> language in Imp.v completely ignores
    issues of concrete syntax &mdash; how an ascii string that a programmer
    might write gets translated into the abstract syntax trees defined
    by the datatypes <span class="inlinecode"><span class="id" type="var">aexp</span></span>, <span class="inlinecode"><span class="id" type="var">bexp</span></span>, and <span class="inlinecode"><span class="id" type="var">com</span></span>.  In this file we
    illustrate how the rest of the story can be filled in by building
    a simple lexical analyzer and parser using Coq's functional
    programming facilities.

<div class="paragraph"> </div>

    This development is not intended to be understood in detail: the
    explanations are fairly terse and there are no exercises.  The
    main point is simply to demonstrate that it can be done.  You are
    invited to look through the code &mdash; most of it is not very
    complicated, though the parser relies on some "monadic"
    programming idioms that may require a little work to make out &mdash;
    but most readers will probably want to just skip down to the
    Examples section at the very end to get the punchline. 
<div class="paragraph"> </div>

<a name="lab342"></a><h1 class="section">Internals</h1>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="SfLib.html#"><span class="id" type="library">SfLib</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Imp.html#"><span class="id" type="library">Imp</span></a>.<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="library">String</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="library">Ascii</span>.<br/>

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">list_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab343"></a><h2 class="section">Lexical Analysis</h2>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Definition</span> <a name="isWhite"><span class="id" type="definition">isWhite</span></a> (<span class="id" type="var">c</span> : <span class="id" type="inductive">ascii</span>) : <span class="id" type="inductive">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="definition">nat_of_ascii</span> <span class="id" type="var">c</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="definition">orb</span> (<span class="id" type="definition">orb</span> (<span class="id" type="definition">beq_nat</span> <span class="id" type="var">n</span> 32)   <span class="comment">(*&nbsp;space&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="definition">beq_nat</span> <span class="id" type="var">n</span> 9))   <span class="comment">(*&nbsp;tab&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="definition">orb</span> (<span class="id" type="definition">beq_nat</span> <span class="id" type="var">n</span> 10)   <span class="comment">(*&nbsp;linefeed&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="definition">beq_nat</span> <span class="id" type="var">n</span> 13)). <span class="comment">(*&nbsp;Carriage&nbsp;return.&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Notation</span> "x '&lt;=?' y" := (<a class="idref" href="SfLib.html#ble_nat"><span class="id" type="definition">ble_nat</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 70, <span class="id" type="var">no</span> <span class="id" type="var">associativity</span>) : <span class="id" type="var">nat_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<span class="id" type="var">c</span> : <span class="id" type="inductive">ascii</span>) : <span class="id" type="inductive">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="definition">nat_of_ascii</span> <span class="id" type="var">c</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">andb</span> (97 &lt;=? <span class="id" type="var">n</span>) (<span class="id" type="var">n</span> &lt;=? 122).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isAlpha"><span class="id" type="definition">isAlpha</span></a> (<span class="id" type="var">c</span> : <span class="id" type="inductive">ascii</span>) : <span class="id" type="inductive">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="definition">nat_of_ascii</span> <span class="id" type="var">c</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">orb</span> (<span class="id" type="definition">andb</span> (65 &lt;=? <span class="id" type="var">n</span>) (<span class="id" type="var">n</span> &lt;=? 90))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="definition">andb</span> (97 &lt;=? <span class="id" type="var">n</span>) (<span class="id" type="var">n</span> &lt;=? 122)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isDigit"><span class="id" type="definition">isDigit</span></a> (<span class="id" type="var">c</span> : <span class="id" type="inductive">ascii</span>) : <span class="id" type="inductive">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="definition">nat_of_ascii</span> <span class="id" type="var">c</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="definition">andb</span> (48 &lt;=? <span class="id" type="var">n</span>) (<span class="id" type="var">n</span> &lt;=? 57).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="chartype"><span class="id" type="inductive">chartype</span></a> := <a name="white"><span class="id" type="constructor">white</span></a> | <a name="alpha"><span class="id" type="constructor">alpha</span></a> | <a name="digit"><span class="id" type="constructor">digit</span></a> | <a name="other"><span class="id" type="constructor">other</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="classifyChar"><span class="id" type="definition">classifyChar</span></a> (<span class="id" type="var">c</span> : <span class="id" type="inductive">ascii</span>) : <a class="idref" href="ImpParser.html#chartype"><span class="id" type="inductive">chartype</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isWhite"><span class="id" type="definition">isWhite</span></a> <span class="id" type="var">c</span> <span class="id" type="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isAlpha"><span class="id" type="definition">isAlpha</span></a> <span class="id" type="var">c</span> <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isDigit"><span class="id" type="definition">isDigit</span></a> <span class="id" type="var">c</span> <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="list_of_string"><span class="id" type="definition">list_of_string</span></a> (<span class="id" type="var">s</span> : <span class="id" type="inductive">string</span>) : <span class="id" type="inductive">list</span> <span class="id" type="inductive">ascii</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">s</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="constructor">EmptyString</span> =&gt; []<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">String</span> <span class="id" type="var">c</span> <span class="id" type="var">s</span> =&gt; <span class="id" type="var">c</span> :: (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">s</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="string_of_list"><span class="id" type="definition">string_of_list</span></a> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <span class="id" type="inductive">ascii</span>) : <span class="id" type="inductive">string</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="definition">fold_right</span> <span class="id" type="constructor">String</span> <span class="id" type="constructor">EmptyString</span> <span class="id" type="var">xs</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="token"><span class="id" type="definition">token</span></a> := <span class="id" type="inductive">string</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> (<span class="id" type="var">cls</span> : <a class="idref" href="ImpParser.html#chartype"><span class="id" type="inductive">chartype</span></a>) (<span class="id" type="var">acc</span> <span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <span class="id" type="inductive">ascii</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" type="inductive">list</span> (<span class="id" type="inductive">list</span> <span class="id" type="inductive">ascii</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tk</span> := <span class="id" type="keyword">match</span> <span class="id" type="var">acc</span> <span class="id" type="keyword">with</span> [] =&gt; [] | <span class="id" type="var">_</span>::_ =&gt; [<span class="id" type="definition">rev</span> <span class="id" type="var">acc</span>] <span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id" type="var">tk</span><br/>
&nbsp;&nbsp;| (<span class="id" type="var">x</span>::<span class="id" type="var">xs'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">cls</span>, <a class="idref" href="ImpParser.html#classifyChar"><span class="id" type="definition">classifyChar</span></a> <span class="id" type="var">x</span>, <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span>, "("      =&gt; <span class="id" type="var">tk</span> ++ ["("]::(<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> [] <span class="id" type="var">xs'</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span>, ")"      =&gt; <span class="id" type="var">tk</span> ++ [")"]::(<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> [] <span class="id" type="var">xs'</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a>, <span class="id" type="var">_</span>    =&gt; <span class="id" type="var">tk</span> ++ (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a> [] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a>,<a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a>,<span class="id" type="var">x</span>  =&gt; <a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a> (<span class="id" type="var">x</span>::<span class="id" type="var">acc</span>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a>,<a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a>,<span class="id" type="var">x</span>  =&gt; <a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a> (<span class="id" type="var">x</span>::<span class="id" type="var">acc</span>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>,<a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>,<span class="id" type="var">x</span>  =&gt; <a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> (<span class="id" type="var">x</span>::<span class="id" type="var">acc</span>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>,<span class="id" type="var">tp</span>,<span class="id" type="var">x</span>         =&gt; <span class="id" type="var">tk</span> ++ (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <span class="id" type="var">tp</span> [<span class="id" type="var">x</span>] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span> %<span class="id" type="var">char</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="tokenize"><span class="id" type="definition">tokenize</span></a> (<span class="id" type="var">s</span> : <span class="id" type="inductive">string</span>) : <span class="id" type="inductive">list</span> <span class="id" type="inductive">string</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="definition">map</span> <a class="idref" href="ImpParser.html#string_of_list"><span class="id" type="definition">string_of_list</span></a> (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a> [] (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">s</span>)).<br/>

<br/>
<span class="id" type="keyword">Example</span> <a name="tokenize_ex1"><span class="id" type="definition">tokenize_ex1</span></a> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tokenize"><span class="id" type="definition">tokenize</span></a> "abc12==3  223*(3+(a+c))" %<span class="id" type="var">string</span><br/>
&nbsp;&nbsp;= ["abc", "12", "==", "3", "223",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"*", "(", "3", "+", "(",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"a", "+", "c", ")", ")"]%<span class="id" type="var">string</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">reflexivity</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab344"></a><h2 class="section">Parsing</h2>

<div class="paragraph"> </div>

<a name="lab345"></a><h3 class="section">Options with Errors</h3>

</div>
<div class="code code-space">

<br/>
<span class="comment">(*&nbsp;An&nbsp;option&nbsp;with&nbsp;error&nbsp;messages.&nbsp;*)</span><br/>
<span class="id" type="keyword">Inductive</span> <a name="optionE"><span class="id" type="inductive">optionE</span></a> (<span class="id" type="var">X</span>:<span class="id" type="keyword">Type</span>) : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="SomeE"><span class="id" type="constructor">SomeE</span></a> : <span class="id" type="var">X</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> <span class="id" type="var">X</span><br/>
&nbsp;&nbsp;| <a name="NoneE"><span class="id" type="constructor">NoneE</span></a> : <span class="id" type="inductive">string</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> <span class="id" type="var">X</span>.<br/>

<br/>
<span class="id" type="keyword">Implicit Arguments</span> <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> [[<span class="id" type="var">X</span>]].<br/>
<span class="id" type="keyword">Implicit Arguments</span> <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> [[<span class="id" type="var">X</span>]].<br/>

<br/>
<span class="comment">(*&nbsp;Some&nbsp;syntactic&nbsp;sugar&nbsp;to&nbsp;make&nbsp;writing&nbsp;nested&nbsp;match-expressions&nbsp;on<br/>
&nbsp;&nbsp;&nbsp;optionE&nbsp;more&nbsp;convenient.&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Notation</span> "'DO' ( x , y ) &lt;== e1 ;; e2" <br/>
&nbsp;&nbsp;&nbsp;:= (<span class="id" type="keyword">match</span> <span class="id" type="var">e1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">x</span>,<span class="id" type="var">y</span>) =&gt; <span class="id" type="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span> =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">right</span> <span class="id" type="var">associativity</span>, <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 60).<br/>

<br/>
<span class="id" type="keyword">Notation</span> "'DO' ( x , y ) &lt;-- e1 ;; e2 'OR' e3" <br/>
&nbsp;&nbsp;&nbsp;:= (<span class="id" type="keyword">match</span> <span class="id" type="var">e1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">x</span>,<span class="id" type="var">y</span>) =&gt; <span class="id" type="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span> =&gt; <span class="id" type="var">e3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">right</span> <span class="id" type="var">associativity</span>, <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 60, <span class="id" type="var">e2</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="var">level</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab346"></a><h3 class="section">Symbol Table</h3>

</div>
<div class="code code-space">

<br/>
<span class="comment">(*&nbsp;Build&nbsp;a&nbsp;mapping&nbsp;from&nbsp;<span class="inlinecode"><span class="id" type="var">tokens</span></span>&nbsp;to&nbsp;<span class="inlinecode"><span class="id" type="var">nats</span></span>.&nbsp;&nbsp;A&nbsp;real&nbsp;parser&nbsp;would&nbsp;do<br/>
&nbsp;&nbsp;&nbsp;this&nbsp;incrementally&nbsp;as&nbsp;it&nbsp;encountered&nbsp;new&nbsp;symbols,&nbsp;but&nbsp;passing<br/>
&nbsp;&nbsp;&nbsp;around&nbsp;the&nbsp;symbol&nbsp;table&nbsp;inside&nbsp;the&nbsp;parsing&nbsp;functions&nbsp;is&nbsp;a&nbsp;bit<br/>
&nbsp;&nbsp;&nbsp;inconvenient,&nbsp;so&nbsp;instead&nbsp;we&nbsp;do&nbsp;it&nbsp;as&nbsp;a&nbsp;first&nbsp;pass.&nbsp;*)</span><br/>
<span class="id" type="keyword">Fixpoint</span> <a name="build_symtable"><span class="id" type="definition">build_symtable</span></a> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) (<span class="id" type="var">n</span> : <span class="id" type="inductive">nat</span>) : (<a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="inductive">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| [] =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> =&gt; <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">x</span>::<span class="id" type="var">xs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> (<span class="id" type="definition">forallb</span> <a class="idref" href="ImpParser.html#isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> =&gt; <span class="id" type="keyword">if</span> <span class="id" type="definition">string_dec</span> <span class="id" type="var">s</span> <span class="id" type="var">x</span> <span class="id" type="keyword">then</span> <span class="id" type="var">n</span> <span class="id" type="keyword">else</span> (<a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <span class="id" type="var">xs</span> (<span class="id" type="constructor">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <span class="id" type="var">xs</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab347"></a><h3 class="section">Generic Combinators for Building Parsers</h3>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">string_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parser"><span class="id" type="definition">parser</span></a> (<span class="id" type="var">T</span> : <span class="id" type="keyword">Type</span>) := <br/>
&nbsp;&nbsp;<span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<span class="id" type="var">T</span> * <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>).<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="many_helper"><span class="id" type="definition">many_helper</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <span class="id" type="var">T</span>) <span class="id" type="var">acc</span> <span class="id" type="var">steps</span> <span class="id" type="var">xs</span> :=<br/>
<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span>, <span class="id" type="var">p</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
| 0, <span class="id" type="var">_</span> =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
| <span class="id" type="var">_</span>, <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ((<span class="id" type="definition">rev</span> <span class="id" type="var">acc</span>), <span class="id" type="var">xs</span>)<br/>
| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span>, <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">t</span>, <span class="id" type="var">xs'</span>) =&gt; <a class="idref" href="ImpParser.html#many_helper"><span class="id" type="definition">many_helper</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">t</span>::<span class="id" type="var">acc</span>) <span class="id" type="var">steps'</span> <span class="id" type="var">xs'</span><br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;A&nbsp;(step-indexed)&nbsp;parser&nbsp;which&nbsp;expects&nbsp;zero&nbsp;or&nbsp;more&nbsp;<span class="inlinecode"><span class="id" type="var">p</span></span>s&nbsp;*)</span><br/>
<span class="id" type="keyword">Fixpoint</span> <a name="many"><span class="id" type="definition">many</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <span class="id" type="var">T</span>) (<span class="id" type="var">steps</span> : <span class="id" type="inductive">nat</span>) : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> (<span class="id" type="inductive">list</span> <span class="id" type="var">T</span>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many_helper"><span class="id" type="definition">many_helper</span></a> <span class="id" type="var">p</span> [] <span class="id" type="var">steps</span>.<br/>

<br/>
<span class="comment">(*&nbsp;A&nbsp;parser&nbsp;which&nbsp;expects&nbsp;a&nbsp;given&nbsp;token,&nbsp;followed&nbsp;by&nbsp;p&nbsp;*)</span><br/>
<span class="id" type="keyword">Definition</span> <a name="firstExpect"><span class="id" type="definition">firstExpect</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">t</span> : <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <span class="id" type="var">T</span>) : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <span class="id" type="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> =&gt; <span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> =&gt; <span class="id" type="keyword">if</span> <span class="id" type="definition">string_dec</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <span class="id" type="var">p</span> <span class="id" type="var">xs'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("expected '" ++ <span class="id" type="var">t</span> ++ "'.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt;  <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("expected '" ++ <span class="id" type="var">t</span> ++ "'.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;A&nbsp;parser&nbsp;which&nbsp;expects&nbsp;a&nbsp;particular&nbsp;token&nbsp;*)</span><br/>
<span class="id" type="keyword">Definition</span> <a name="expect"><span class="id" type="definition">expect</span></a> (<span class="id" type="var">t</span> : <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <span class="id" type="inductive">unit</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> <span class="id" type="var">t</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> =&gt; <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="constructor">tt</span>, <span class="id" type="var">xs</span>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab348"></a><h3 class="section">A Recursive-Descent Parser for Imp</h3>

</div>
<div class="code code-space">

<br/>
<span class="comment">(*&nbsp;Identifiers&nbsp;*)</span><br/>
<span class="id" type="keyword">Definition</span> <a name="parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> (<span class="id" type="var">symtable</span> :<span class="id" type="inductive">string</span><span style="font-family: arial;">&rarr;</span><span class="id" type="inductive">nat</span>) (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> * <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
<span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
| [] =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected identifier"<br/>
| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <span class="id" type="definition">forallb</span> <a class="idref" href="ImpParser.html#isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>) <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="SfLib.html#Id"><span class="id" type="constructor">Id</span></a> (<span class="id" type="var">symtable</span> <span class="id" type="var">x</span>), <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("Illegal identifier:'" ++ <span class="id" type="var">x</span> ++ "'")<br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Numbers&nbsp;*)</span><br/>
<span class="id" type="keyword">Definition</span> <a name="parseNumber"><span class="id" type="definition">parseNumber</span></a> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) : <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<span class="id" type="inductive">nat</span> * <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
<span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span> <br/>
| [] =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected number"<br/>
| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <span class="id" type="definition">forallb</span> <a class="idref" href="ImpParser.html#isDigit"><span class="id" type="definition">isDigit</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>) <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="definition">fold_left</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> <span class="id" type="var">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 * <span class="id" type="var">n</span> + (<span class="id" type="definition">nat_of_ascii</span> <span class="id" type="var">d</span> - <span class="id" type="definition">nat_of_ascii</span> "0"%<span class="id" type="var">char</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected number"<br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Parse&nbsp;arithmetic&nbsp;expressions&nbsp;*)</span><br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) <span class="id" type="var">symtable</span> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) <br/>
&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> * <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">i</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#AId"><span class="id" type="constructor">AId</span></a> <span class="id" type="var">i</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">n</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#parseNumber"><span class="id" type="definition">parseNumber</span></a> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> (<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>)  &lt;== <a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "(" (<a class="idref" href="ImpParser.html#parseSumExp"><span class="id" type="definition">parseSumExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">u</span>, <span class="id" type="var">rest'</span>) &lt;== <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> ")" <span class="id" type="var">rest</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<span class="id" type="keyword">with</span> <a name="parseProductExp"><span class="id" type="definition">parseProductExp</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) <span class="id" type="var">symtable</span> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)  :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "*" (<a class="idref" href="ImpParser.html#parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>)) <span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="definition">fold_left</span> <a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> <span class="id" type="var">es</span> <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<span class="id" type="keyword">with</span> <a name="parseSumExp"><span class="id" type="definition">parseSumExp</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) <span class="id" type="var">symtable</span> (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)  :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "+" (<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ( (<span class="id" type="constructor">true</span>, <span class="id" type="var">e</span>), <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "-" (<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ( (<span class="id" type="constructor">false</span>, <span class="id" type="var">e</span>), <span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="definition">fold_left</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">e0</span> <span class="id" type="var">term</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">term</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="constructor">true</span>,  <span class="id" type="var">e</span>) =&gt; <a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <span class="id" type="var">e0</span> <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="constructor">false</span>, <span class="id" type="var">e</span>) =&gt; <a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <span class="id" type="var">e0</span> <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">es</span> <span class="id" type="var">e</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rest'</span>)         <br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseAExp"><span class="id" type="definition">parseAExp</span></a> := <a class="idref" href="ImpParser.html#parseSumExp"><span class="id" type="definition">parseSumExp</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Parsing&nbsp;boolean&nbsp;expressions.&nbsp;*)</span><br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) (<span class="id" type="var">symtable</span> : <span class="id" type="inductive">string</span><span style="font-family: arial;">&rarr;</span><span class="id" type="inductive">nat</span>) (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)  :=<br/>
<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span>    (<span class="id" type="var">u</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "true" <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a>,<span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">u</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "false" <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>,<span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "not" (<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <span class="id" type="var">e</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "(" (<a class="idref" href="ImpParser.html#parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">DO</span> (<span class="id" type="var">u</span>,<span class="id" type="var">rest'</span>) &lt;== <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> ")" <span class="id" type="var">rest</span>;; <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">DO</span> (<span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "==" (<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">e</span> <span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "&lt;=" (<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">e</span> <span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected '==' or '&lt;=' after arithmetic expression")<br/>
<span class="id" type="keyword">end</span><br/>
<span class="id" type="keyword">with</span> <a name="parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) (<span class="id" type="var">symtable</span> : <span class="id" type="inductive">string</span><span style="font-family: arial;">&rarr;</span><span class="id" type="inductive">nat</span>) (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)   :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "&amp;&amp;" (<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>)) <span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="definition">fold_left</span> <a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <span class="id" type="var">es</span> <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseBExp"><span class="id" type="definition">parseBExp</span></a> := <a class="idref" href="ImpParser.html#parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;<br/>
Eval&nbsp;compute&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;(parseProductExp&nbsp;100&nbsp;(tokenize&nbsp;"x*y*(x*x)*x")).<br/>
<br/>
Eval&nbsp;compute&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;(parseDisjunctionExp&nbsp;100&nbsp;(tokenize&nbsp;"not((x==x||x*x&lt;=(x*x)*x)&amp;&amp;x==x)")).&nbsp;<br/>
*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Parsing&nbsp;commands&nbsp;*)</span><br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parseSimpleCommand"><span class="id" type="definition">parseSimpleCommand</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) (<span class="id" type="var">symtable</span>:<span class="id" type="inductive">string</span><span style="font-family: arial;">&rarr;</span><span class="id" type="inductive">nat</span>) (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">u</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "SKIP" <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">SKIP</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "IF" (<a class="idref" href="ImpParser.html#parseBExp"><span class="id" type="definition">parseBExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">c</span>,<span class="id" type="var">rest'</span>)  &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "THEN" (<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">c'</span>,<span class="id" type="var">rest''</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "ELSE" (<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest'</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">u</span>,<span class="id" type="var">rest'''</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "END" <span class="id" type="var">rest''</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">IFB</span> <span class="id" type="var">e</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c'</span> <span class="id" type="var">FI</span>, <span class="id" type="var">rest'''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "WHILE" (<a class="idref" href="ImpParser.html#parseBExp"><span class="id" type="definition">parseBExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">c</span>,<span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "DO" (<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">u</span>,<span class="id" type="var">rest''</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "END" <span class="id" type="var">rest'</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">WHILE</span> <span class="id" type="var">e</span> <span class="id" type="var">DO</span> <span class="id" type="var">c</span> <span class="id" type="var">END</span>, <span class="id" type="var">rest''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <span class="id" type="var">DO</span> (<span class="id" type="var">i</span>, <span class="id" type="var">rest</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> ":=" (<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">i</span> ::= <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<br/>
<span class="id" type="keyword">with</span> <a name="parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> (<span class="id" type="var">steps</span>:<span class="id" type="inductive">nat</span>) (<span class="id" type="var">symtable</span>:<span class="id" type="inductive">string</span><span style="font-family: arial;">&rarr;</span><span class="id" type="inductive">nat</span>) (<span class="id" type="var">xs</span> : <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">steps</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="constructor">S</span> <span class="id" type="var">steps'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">c</span>, <span class="id" type="var">rest</span>) &lt;== <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseSimpleCommand"><span class="id" type="definition">parseSimpleCommand</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span> <span class="id" type="var">xs</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">DO</span> (<span class="id" type="var">c'</span>, <span class="id" type="var">rest'</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> ";" (<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <span class="id" type="var">symtable</span>) <span class="id" type="var">rest</span>;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">c</span> ; <span class="id" type="var">c'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">c</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parse"><span class="id" type="definition">parse</span></a> (<span class="id" type="var">str</span> : <span class="id" type="inductive">string</span>) : <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="Imp.html#com"><span class="id" type="inductive">com</span></a> * <span class="id" type="inductive">list</span> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tokens</span> := <a class="idref" href="ImpParser.html#tokenize"><span class="id" type="definition">tokenize</span></a> <span class="id" type="var">str</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> 1000 (<a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <span class="id" type="var">tokens</span> 0) <span class="id" type="var">tokens</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab349"></a><h1 class="section">Examples</h1>

</div>
<div class="code code-space">

<br/>
<span class="comment">(*<br/>
Eval&nbsp;compute&nbsp;in&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;x&nbsp;==&nbsp;y&nbsp;+&nbsp;1&nbsp;+&nbsp;2&nbsp;-&nbsp;y&nbsp;*&nbsp;6&nbsp;+&nbsp;3&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;x&nbsp;*&nbsp;1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;&nbsp;".<br/>
====&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(IFB&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(APlus<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMinus&nbsp;(APlus&nbsp;(APlus&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;1))&nbsp;(ANum&nbsp;2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;6)))&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ANum&nbsp;3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(ANum&nbsp;1);&nbsp;Id&nbsp;1&nbsp;::=&nbsp;ANum&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP&nbsp;FI,&nbsp;<span class="inlinecode"></span>)<br/>
*)</span><br/>

<br/>
<span class="comment">(*<br/>
Eval&nbsp;compute&nbsp;in&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;SKIP;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;z:=x*y*(x*x);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;x==x&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;z&nbsp;&lt;=&nbsp;z*z&nbsp;&amp;&amp;&nbsp;not&nbsp;x&nbsp;==&nbsp;2&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;z;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;z<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;END;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;x:=z&nbsp;&nbsp;".<br/>
====&gt;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SKIP;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;DO&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFB&nbsp;BAnd&nbsp;(BLe&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AId&nbsp;(Id&nbsp;0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(BNot&nbsp;(BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0);&nbsp;Id&nbsp;2&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0)&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP&nbsp;FI;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0),&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"></span>)&nbsp;<br/>
*)</span><br/>

<br/>
<span class="comment">(*<br/>
Eval&nbsp;compute&nbsp;in&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;&nbsp;SKIP;<br/>
&nbsp;&nbsp;&nbsp;z:=x*y*(x*x);<br/>
&nbsp;&nbsp;&nbsp;WHILE&nbsp;x==x&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;z&nbsp;&lt;=&nbsp;z*z&nbsp;&amp;&amp;&nbsp;not&nbsp;x&nbsp;==&nbsp;2&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;z;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;z<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;END;<br/>
&nbsp;&nbsp;&nbsp;x:=z&nbsp;&nbsp;".<br/>
=====&gt;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SKIP;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;DO&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFB&nbsp;BAnd&nbsp;(BLe&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AId&nbsp;(Id&nbsp;0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(BNot&nbsp;(BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0);&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;2&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0)&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FI;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0),&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"></span>).<br/>
*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>