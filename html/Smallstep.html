<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Smallstep: Small-step Operational Semantics</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Smallstep<span class="subtitle">Small-step Operational Semantics</span></h1>

<div class="code code-tight">
</div>

<div class="doc">

</div>
<div class="code code-tight">

<br/>
<span class="comment">(*&nbsp;$Date:&nbsp;2011-05-07&nbsp;16:41:12&nbsp;-0400&nbsp;(Sat,&nbsp;07&nbsp;May&nbsp;2011)&nbsp;$&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="Imp.html#"><span class="id" type="library">Imp</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="library">Relations</span>.<br/>

<br/>
</div>

<div class="doc">
The evaluators we have seen so far (e.g., the ones for <span class="inlinecode"><span class="id" type="var">aexp</span></span>s,
    <span class="inlinecode"><span class="id" type="var">bexp</span></span>s, and commands) have been formulated in a "big-step"
    style &mdash; they specify how a given expression can be evaluated to
    its final value (or a command plus a store to a final store) "all
    in one big step."

<div class="paragraph"> </div>

    This style is simple and natural for many purposes (indeed, Gilles
    Kahn, who popularized its use, called it <i>natural semantics</i>), but
    there are some things it does not do well.  In particular, it
    does not give us a natural way of talking about <i>concurrent</i>
    programming languages, where the "semantics" of a program &mdash; i.e.,
    the essence of how it behaves &mdash; is not just which input states
    get mapped to which output states, but also includes the
    intermediate states that it passes through along the way, since
    these states can also be observed by concurrently executing code.

<div class="paragraph"> </div>

    Another shortcoming of the big-step style is more technical, but
    critical for some applications.  Consider the variant of Imp with
    lists that we introduced in ImpList.v.  We chose to define the
    meaning of programs like <span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" type="var">nil</span></span> by specifying that a list
    should be interpreted as <span class="inlinecode">0</span> when it occurs in a context expecting
    a number, but this was a bit of a hack.  It would be better simply
    to say that the behavior of such a program is <i>undefined</i> &mdash; it
    doesn't evaluate to any result.  We could easily do this: we'd
    just have to use the formulations of <span class="inlinecode"><span class="id" type="var">aeval</span></span> and <span class="inlinecode"><span class="id" type="var">beval</span></span> as
    inductive propositions (rather than Fixpoints), so that we can
    make them partial functions instead of total ones.

<div class="paragraph"> </div>

    However, this way of defining Imp has a serious deficiency.  In
    this language, a command might <i>fail</i> to map a given starting
    state to any ending state for two quite different reasons: either
    because the execution gets into an infinite loop or because, at
    some point, the program tries to do an operation that makes no
    sense, such as taking the successor of a boolean variable, and
    none of the evaluation rules can be applied.

<div class="paragraph"> </div>

    These two outcomes &mdash; nontermination vs. getting stuck in an
    erroneous configuration &mdash; are quite different.  In particular, we
    want to allow the first (permitting the possibility of infinite
    loops is the price we pay for the convenience of programming with
    general looping constructs like <span class="inlinecode"><span class="id" type="var">while</span></span>) but prevent the
    second (which is just wrong), for example by adding some form of
    <i>typechecking</i> to the language.  Indeed, this will be a major
    topic for the rest of the course.  As a first step, we need a
    different way of presenting the semantics that allows us to
    distinguish nontermination from erroneous "stuck states."

<div class="paragraph"> </div>

    So, for lots of reasons, we'd like to have a finer-grained way of
    defining and reasoning about program behaviors.  This is the topic
    of the present chapter.  We replace the "big-step" <span class="inlinecode"><span class="id" type="var">eval</span></span> relation
    with a "small-step" relation that specifies, for a given program,
    how the "atomic steps" of computation are performed. 
<div class="paragraph"> </div>

<a name="lab443"></a><h1 class="section">A Toy Language</h1>

<div class="paragraph"> </div>

 To save space in the discussion, let's go back to an
    incredibly simple language containing just constants and addition.
    At the end of the chapter, we'll see how to apply the same
    techniques to the full Imp language. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="tm"><span class="id" type="inductive">tm</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="tm_const"><span class="id" type="constructor">tm_const</span></a> : <span class="id" type="inductive">nat</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tm_plus"><span class="id" type="constructor">tm_plus</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "tm_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_const" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_plus" ].<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="SimpleArith0"><span class="id" type="module">SimpleArith0</span></a>.<br/>

<br/>
</div>

<div class="doc">
Here is a standard evaluator for this language, written in the
    same (big-step) style as we've been using up to this point. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="SimpleArith0.eval"><span class="id" type="definition">eval</span></a> (<span class="id" type="var">t</span> : <a class="idref" href="Smallstep.html#SimpleArith0.tm"><span class="id" type="inductive">tm</span></a>) : <span class="id" type="inductive">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Smallstep.html#SimpleArith0.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span> =&gt; <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Smallstep.html#SimpleArith0.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> =&gt; <a class="idref" href="Smallstep.html#eval"><span class="id" type="definition">eval</span></a> <span class="id" type="var">a1</span> + <a class="idref" href="Smallstep.html#eval"><span class="id" type="definition">eval</span></a> <span class="id" type="var">a2</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">SimpleArith0</span></a>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="SimpleArith1"><span class="id" type="module">SimpleArith1</span></a>.<br/>

<br/>
</div>

<div class="doc">
Now, here is the same evaluator, written in exactly the same
    style, but formulated as an inductively defined relation.  Again,
    we use the notation <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span style="font-family: arial;">&dArr;</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span> for "<span class="inlinecode"><span class="id" type="var">t</span></span> evaluates to <span class="inlinecode"><span class="id" type="var">n</span></span>." 
<div class="paragraph"> </div>

<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (E_Const) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">n&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;n</td>
  <td></td>
</td>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;n1</td>
  <td></td>
</td>
<tr class="infruleassumption">
  <td class="infrule">t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;n2</td>
  <td class="infrulenamecol" rowspan="3">
    (E_Plus) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;+&nbsp;t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;plus&nbsp;n1&nbsp;n2</td>
  <td></td>
</td>
</table></center>    We write <span class="inlinecode"><span class="id" type="var">plus</span></span> <span class="inlinecode"><span class="id" type="var">n1</span></span> <span class="inlinecode"><span class="id" type="var">n2</span></span> in the second rule, rather than <span class="inlinecode"><span class="id" type="var">n1</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" type="var">n2</span></span>,
    to emphasize the fact that the <span class="inlinecode">+</span> on the left of the <span class="inlinecode"><span style="font-family: arial;">&dArr;</span></span> is an
    abstract-syntax-tree node while the addition on the right of the
    <span class="inlinecode"><span style="font-family: arial;">&dArr;</span></span> is the mathematical sum of the numbers <span class="inlinecode"><span class="id" type="var">n1</span></span> and <span class="inlinecode"><span class="id" type="var">n2</span></span>.  The
    formal Coq version of the definition is more pedantic about this
    distinction: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&dArr;</span>' n " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 50, <span class="id" type="var">left</span> <span class="id" type="var">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="SimpleArith1.eval"><span class="id" type="inductive">eval</span></a> : <a class="idref" href="Smallstep.html#SimpleArith1.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="inductive">nat</span> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="SimpleArith1.E_Const"><span class="id" type="constructor">E_Const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith1.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;| <a name="SimpleArith1.E_Plus"><span class="id" type="constructor">E_Plus</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">n1</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">n2</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&dArr;</span>' n " := (<a class="idref" href="Smallstep.html#eval"><span class="id" type="inductive">eval</span></a> <span class="id" type="var">t</span> <span class="id" type="var">n</span>).<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">SimpleArith1</span></a>.<br/>

<br/>
</div>

<div class="doc">
Here is a slight variation, still in big-step style, where
    the final result of evaluating a term is also a term, rather than
    a bare number. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&dArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 50, <span class="id" type="var">left</span> <span class="id" type="var">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="eval"><span class="id" type="inductive">eval</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="E_Const"><span class="id" type="constructor">E_Const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span> <span style="font-family: arial;">&dArr;</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span><br/>
&nbsp;&nbsp;| <a name="E_Plus"><span class="id" type="constructor">E_Plus</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">n1</span> <span class="id" type="var">t2</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&dArr;</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&dArr;</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&dArr;</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&dArr;</span>' t' " := (<a class="idref" href="Smallstep.html#eval"><span class="id" type="inductive">eval</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
(Note that this doesn't change anything in the informal rules,
    where we are eliding the distinction between the constant <i>term</i>
    <span class="inlinecode"><span class="id" type="var">n</span></span> and the bare <i>number</i> <span class="inlinecode"><span class="id" type="var">n</span></span>.) 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "eval_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "E_Const" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "E_Plus" ].<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="SimpleArith2"><span class="id" type="module">SimpleArith2</span></a>.<br/>

<br/>
</div>

<div class="doc">
Now, here is a small-step version. 
<div class="paragraph"> </div>

<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_PlusConstConst) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">n1&nbsp;+&nbsp;n2&nbsp;<span style="font-family: arial;">&rArr;</span>&nbsp;plus&nbsp;n1&nbsp;n2</td>
  <td></td>
</td>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t1'</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_Plus1) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;+&nbsp;t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t1'&nbsp;+&nbsp;t2</td>
  <td></td>
</td>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t2'</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_Plus2) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">n1&nbsp;+&nbsp;t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;n1&nbsp;+&nbsp;t2'</td>
  <td></td>
</td>
</table></center> Note that we're using variable names here to lighten the notation:
    by convention, <span class="inlinecode"><span class="id" type="var">n1</span></span> and <span class="inlinecode"><span class="id" type="var">n2</span></span> refer only to constants (constructed
    with <span class="inlinecode"><span class="id" type="var">tm_const</span></span>), while <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> refer to arbitrary terms.
    In the formal rules, we use explicit constructors to make the same
    distinction. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="SimpleArith2.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#SimpleArith2.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#SimpleArith2.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="SimpleArith2.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>) <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="SimpleArith2.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="SimpleArith2.ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) <span class="id" type="var">t2'</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
Things to notice:

<div class="paragraph"> </div>

<ul class="doclist">
<li> We are defining just a single reduction step, in which
      one <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> node is replaced by its value.

<div class="paragraph"> </div>


</li>
<li> Each step finds the <i>leftmost</i> <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> node that is ready to
      go (both of its operands are constants) and rewrites it in
      place.  The first rule tells how to rewrite this <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> node
      itself; the other two rules tell how to find it.

<div class="paragraph"> </div>


</li>
<li> A term that is just a constant cannot take a step. 
</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "step_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_PlusConstConst"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus1" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus2" ].<br/>

<br/>
</div>

<div class="doc">
A couple of examples of reasoning with the <span class="inlinecode"><span class="id" type="var">step</span></span>
    relation... 
<div class="paragraph"> </div>

 If <span class="inlinecode"><span class="id" type="var">t1</span></span> can take a step to <span class="inlinecode"><span class="id" type="var">t1'</span></span>, then <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> steps
    to <span class="inlinecode"><span class="id" type="var">plus</span></span> <span class="inlinecode"><span class="id" type="var">t1'</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Example</span> <a name="SimpleArith2.test_step_1"><span class="id" type="definition">test_step_1</span></a> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 2) (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 4))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 0 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 2) (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 4)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#SimpleArith2.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#SimpleArith2.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab444"></a><h4 class="section">Exercise: 2 stars (test_step_2)</h4>
 Right-hand sides of sums can take a step only when the
    left-hand side is finished: if <span class="inlinecode"><span class="id" type="var">t2</span></span> can take a step to <span class="inlinecode"><span class="id" type="var">t2'</span></span>,
    then <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode">(<span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span>)</span> <span class="inlinecode"><span class="id" type="var">t2</span></span> steps to <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode">(<span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span>)</span>
    <span class="inlinecode"><span class="id" type="var">t2'</span></span>: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Example</span> <a name="SimpleArith2.test_step_2"><span class="id" type="definition">test_step_2</span></a> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 2) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 3)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> 2) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#SimpleArith2.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 0 3))).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 One interesting property of the <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> relation is that, like the
    evaluation relation for our language of Imp programs, it is
    <i>deterministic</i>.

<div class="paragraph"> </div>

    <i>Theorem</i>: For each <span class="inlinecode"><span class="id" type="var">t</span></span>, there is at most one <span class="inlinecode"><span class="id" type="var">t'</span></span> such that <span class="inlinecode"><span class="id" type="var">t</span></span>
    steps to <span class="inlinecode"><span class="id" type="var">t'</span></span> (<span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> is provable).  Formally, this is the
    same as saying that <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> is a partial function.

<div class="paragraph"> </div>

    <i>Proof sketch</i>: We show that if <span class="inlinecode"><span class="id" type="var">x</span></span> steps to both <span class="inlinecode"><span class="id" type="var">y1</span></span> and <span class="inlinecode"><span class="id" type="var">y2</span></span>
    then <span class="inlinecode"><span class="id" type="var">y1</span></span> and <span class="inlinecode"><span class="id" type="var">y2</span></span> are equal, by induction on a derivation of
    <span class="inlinecode"><span class="id" type="var">step</span></span> <span class="inlinecode"><span class="id" type="var">x</span></span> <span class="inlinecode"><span class="id" type="var">y1</span></span>.  There are several cases to consider, depending on
    the last rule used in this derivation and in the given derivation
    of <span class="inlinecode"><span class="id" type="var">step</span></span> <span class="inlinecode"><span class="id" type="var">x</span></span> <span class="inlinecode"><span class="id" type="var">y2</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> If both are <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span>, the result is immediate.

<div class="paragraph"> </div>


</li>
<li> The cases when both derivations end with <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> or
        <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span> follow by the induction hypothesis.  

<div class="paragraph"> </div>


</li>
<li> It cannot happen that one is <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span> and the other
        is <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> or <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span>, since this would imply that <span class="inlinecode"><span class="id" type="var">x</span></span> has
        the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> where both <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> are
        constants (by <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span>) <i>and</i> one of <span class="inlinecode"><span class="id" type="var">t1</span></span> or <span class="inlinecode"><span class="id" type="var">t2</span></span> has
        the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode">...</span>.

<div class="paragraph"> </div>


</li>
<li> Similarly, it cannot happen that one is <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> and the other
        is <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span>, since this would imply that <span class="inlinecode"><span class="id" type="var">x</span></span> has the form
        <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> where <span class="inlinecode"><span class="id" type="var">t1</span></span> has both the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> and
        the form <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span>. <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="SimpleArith2.step_deterministic"><span class="id" type="lemma">step_deterministic</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="SfLib.html#partial_function"><span class="id" type="definition">partial_function</span></a> <a class="idref" href="Smallstep.html#SimpleArith2.step"><span class="id" type="inductive">step</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">partial_function</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">Hy1</span> <span class="id" type="var">Hy2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">y2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">step_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">Hy1</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">y2</span> <span class="id" type="var">Hy2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "ST_PlusConstConst". <span class="id" type="var">step_cases</span> (<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy2</span>) <span class="id" type="var">SCase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_PlusConstConst". <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus1". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus2". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "ST_Plus1". <span class="id" type="var">step_cases</span> (<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy2</span>) <span class="id" type="var">SCase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_PlusConstConst". <span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hy1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> (<span class="id" type="var">IHHy1</span> <span class="id" type="var">t1'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>. <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus2". <span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hy1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "ST_Plus2". <span class="id" type="var">step_cases</span> (<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy2</span>) <span class="id" type="var">SCase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_PlusConstConst". <span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hy1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hy1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus1". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_Plus2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> (<span class="id" type="var">IHHy1</span> <span class="id" type="var">t2'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>. <span class="id" type="tactic">assumption</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">SimpleArith2</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab445"></a><h2 class="section">Values</h2>

<div class="paragraph"> </div>

 Let's take a moment to slightly generalize the way we state the
    definition of single-step reduction.  
<div class="paragraph"> </div>

 It is useful to think of the <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> relation as defining an
    <i>abstract machine</i>:

<div class="paragraph"> </div>

<ul class="doclist">
<li> At any moment, the <i>state</i> of the machine is a term.

<div class="paragraph"> </div>


</li>
<li> A <i>step</i> of the machine is an atomic unit of computation &mdash;
        here, a single "add" operation.

<div class="paragraph"> </div>


</li>
<li> The <i>halting states</i> of the machine are ones where there is no
        more computation to be done.

</li>
</ul>

<div class="paragraph"> </div>

    We can then execute a term <span class="inlinecode"><span class="id" type="var">t</span></span> as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Take <span class="inlinecode"><span class="id" type="var">t</span></span> as the starting state of the machine.

<div class="paragraph"> </div>


</li>
<li> Repeatedly use the <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> relation to find a sequence of
        machine states, starting with <span class="inlinecode"><span class="id" type="var">t</span></span>, where each state steps to
        the next.

<div class="paragraph"> </div>


</li>
<li> When no more reduction is possible, "read out" the final state
        of the machine as the result of execution. 
</li>
</ul>

<div class="paragraph"> </div>

 Intuitively, it is clear that the final states of the
    machine are always terms of the form <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span> for some <span class="inlinecode"><span class="id" type="var">n</span></span>.
    We call such terms <i>values</i>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="v_const"><span class="id" type="constructor">v_const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>).<br/>

<br/>
</div>

<div class="doc">
Having introduced the idea of values, we can use it in the
    definition of the <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> relation to write <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span> rule in a
    slightly more intuitive way: 
<div class="paragraph"> </div>

<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_PlusConstConst) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">n1&nbsp;+&nbsp;n2&nbsp;<span style="font-family: arial;">&rArr;</span>&nbsp;plus&nbsp;n1&nbsp;n2</td>
  <td></td>
</td>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t1'</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_Plus1) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">t1&nbsp;+&nbsp;t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t1'&nbsp;+&nbsp;t2</td>
  <td></td>
</td>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;t2'</td>
  <td class="infrulenamecol" rowspan="3">
    (ST_Plus2) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">v1&nbsp;+&nbsp;t2&nbsp;<span style="font-family: arial;">&dArr;</span>&nbsp;v1&nbsp;+&nbsp;t2'</td>
  <td></td>
</td>
</table></center> Again, the variable names here carry important information:
    by convention, <span class="inlinecode"><span class="id" type="var">v1</span></span> ranges only over values, while <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span>
    range over arbitrary terms.  In the Coq version of the rules, we
    use an explicit <span class="inlinecode"><span class="id" type="var">value</span></span> hypothesis for the same purpose. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span>                     <span class="comment">(*&nbsp;&lt;-----&nbsp;n.b.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2'</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "step_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_PlusConstConst"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus1" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus2" ].<br/>

<br/>
</div>

<div class="doc">
<a name="lab446"></a><h4 class="section">Exercise: 3 stars, recommended (redo_determinacy)</h4>
 As a sanity check on this change, let's re-verify determinacy 

<div class="paragraph"> </div>

    Proof sketch: We must show that if <span class="inlinecode"><span class="id" type="var">x</span></span> steps to both <span class="inlinecode"><span class="id" type="var">y1</span></span> and <span class="inlinecode"><span class="id" type="var">y2</span></span>
    then <span class="inlinecode"><span class="id" type="var">y1</span></span> and <span class="inlinecode"><span class="id" type="var">y2</span></span> are equal.  Consider the final rules used in
    the derivations of <span class="inlinecode"><span class="id" type="var">step</span></span> <span class="inlinecode"><span class="id" type="var">x</span></span> <span class="inlinecode"><span class="id" type="var">y1</span></span> and <span class="inlinecode"><span class="id" type="var">step</span></span> <span class="inlinecode"><span class="id" type="var">x</span></span> <span class="inlinecode"><span class="id" type="var">y2</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> If both are <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span>, the result is immediate.

<div class="paragraph"> </div>


</li>
<li> It cannot happen that one is <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span> and the other
      is <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> or <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span>, since this would imply that <span class="inlinecode"><span class="id" type="var">x</span></span> has
      the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> where both <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> are
      constants (by <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span>) AND one of <span class="inlinecode"><span class="id" type="var">t1</span></span> or <span class="inlinecode"><span class="id" type="var">t2</span></span> has
      the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode">...</span>.

<div class="paragraph"> </div>


</li>
<li> Similarly, it cannot happen that one is <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> and the other
      is <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span>, since this would imply that <span class="inlinecode"><span class="id" type="var">x</span></span> has the form
      <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> where <span class="inlinecode"><span class="id" type="var">t1</span></span> both has the form <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> and
      is a value (hence has the form <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span>).

<div class="paragraph"> </div>


</li>
<li> The cases when both derivations end with <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span> or
      <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span> follow by the induction hypothesis. <font size=-2>&#9744;</font> 
</li>
</ul>

<div class="paragraph"> </div>

 Most of this proof is the same as the one above.  But to get
    maximum benefit from the exercise you should try to write it from
    scratch and just use the earlier one if you get stuck. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="step_deterministic"><span class="id" type="lemma">step_deterministic</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="SfLib.html#partial_function"><span class="id" type="definition">partial_function</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab447"></a><h2 class="section">Strong Progress and Normal Forms</h2>

<div class="paragraph"> </div>

 The definition of single-step reduction for our toy language is
    fairly simple, but for a larger language it would be pretty easy
    to forget one of the rules and create a situation where some term
    cannot take a step even though it has not been completely reduced
    to a value.  The following theorem shows that we did not, in fact,
    make such a mistake here. 
<div class="paragraph"> </div>

 <i>Theorem</i> (<i>Strong Progress</i>): For all <span class="inlinecode"><span class="id" type="var">t</span>:<span class="id" type="var">tm</span></span>, either <span class="inlinecode"><span class="id" type="var">t</span></span> is a
    value, or there exists a term <span class="inlinecode"><span class="id" type="var">t'</span></span> such that <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span>.

<div class="paragraph"> </div>

    <i>Proof</i>: By induction on <span class="inlinecode"><span class="id" type="var">t</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Suppose <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span>. Then <span class="inlinecode"><span class="id" type="var">t</span></span> is a <span class="inlinecode"><span class="id" type="var">value</span></span>.

<div class="paragraph"> </div>


</li>
<li> Suppose <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>, where (by the IH) <span class="inlinecode"><span class="id" type="var">t1</span></span> is either a
      value or can step to some <span class="inlinecode"><span class="id" type="var">t1'</span></span>, and where <span class="inlinecode"><span class="id" type="var">t2</span></span> is either a
      value or can step to some <span class="inlinecode"><span class="id" type="var">t2'</span></span>. We must show <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> is
      either a value or steps to some <span class="inlinecode"><span class="id" type="var">t'</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> If <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> are both values, then <span class="inlinecode"><span class="id" type="var">t</span></span> can take a step, by
        <span class="inlinecode"><span class="id" type="var">ST_PlusConstConst</span></span>.

<div class="paragraph"> </div>


</li>
<li> If <span class="inlinecode"><span class="id" type="var">t1</span></span> is a value and <span class="inlinecode"><span class="id" type="var">t2</span></span> can take a step, then so can <span class="inlinecode"><span class="id" type="var">t</span></span>,
        by <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span>.

<div class="paragraph"> </div>


</li>
<li> If <span class="inlinecode"><span class="id" type="var">t1</span></span> can take a step, then so can <span class="inlinecode"><span class="id" type="var">t</span></span>, by <span class="inlinecode"><span class="id" type="var">ST_Plus1</span></span>.  <font size=-2>&#9744;</font> 
</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>

 This important property is called <i>strong progress</i>, because
    every term either is a value or can "make progress" by stepping to
    some other term.  (The qualifier "strong" distinguishes it from a
    more refined version that we'll see in later chapters, called
    simply "progress.") 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="strong_progress"><span class="id" type="lemma">strong_progress</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&or;</span> (<span style="font-family: arial;">&exist;</span> <span class="id" type="var">t'</span>, <span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t'</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>) <span class="id" type="var">Case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tm_const". <span class="id" type="var">left</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tm_plus". <span class="id" type="var">right</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "l". <span class="id" type="tactic">inversion</span> <span class="id" type="var">IHt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SSCase</span> "l". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n</span> <span class="id" type="var">n0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SSCase</span> "r". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t'</span> <span class="id" type="var">H1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "r". <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t'</span> <span class="id" type="var">H0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t'</span> <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The idea of "making progress" can be extended to tell us something
    interesting about <span class="inlinecode"><span class="id" type="var">value</span></span>s: they are exactly the terms that
    <i>cannot</i> make progress in this sense.  To state this fact, let's
    begin by giving a name to terms that cannot make progress: We'll
    call them <i>normal forms</i>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="normal_form"><span class="id" type="definition">normal_form</span></a> {<span class="id" type="var">X</span>:<span class="id" type="keyword">Type</span>} (<span class="id" type="var">R</span>:<span class="id" type="definition">relation</span> <span class="id" type="var">X</span>) (<span class="id" type="var">t</span>:<span class="id" type="var">X</span>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;~ <span style="font-family: arial;">&exist;</span> <span class="id" type="var">t'</span>, <span class="id" type="var">R</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>.<br/>

<br/>
</div>

<div class="doc">
This definition actually specifies what it is to be a normal form
    for an <i>arbitrary</i> relation <span class="inlinecode"><span class="id" type="var">R</span></span> over an arbitrary set <span class="inlinecode"><span class="id" type="var">X</span></span>, not
    just for the particular single-step reduction relation over terms
    that we are interested in at the moment.  We'll re-use the same
    terminology for talking about other relations later in the
    course. 
<div class="paragraph"> </div>

 We can use this terminology to generalize the observation we made
    in the strong progress theorem: in this language, normal forms and
    values are actually the same thing. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="value_is_nf"><span class="id" type="lemma">value_is_nf</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">contra</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">contra</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="nf_is_value"><span class="id" type="lemma">nf_is_value</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="comment">(*&nbsp;a&nbsp;corollary&nbsp;of&nbsp;<span class="inlinecode"><span class="id" type="var">strong_progress</span></span>...&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">G</span> : <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&or;</span> <span style="font-family: arial;">&exist;</span> <span class="id" type="var">t'</span>, <span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "Proof of assertion". <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#strong_progress"><span class="id" type="lemma">strong_progress</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">G</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "l". <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "r". <span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#ex_falso_quodlibet"><span class="id" type="lemma">ex_falso_quodlibet</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">assumption</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Corollary</span> <a name="nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&harr;</span> <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#nf_is_value"><span class="id" type="lemma">nf_is_value</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#value_is_nf"><span class="id" type="lemma">value_is_nf</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Why is this interesting?  For two reasons:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Because <span class="inlinecode"><span class="id" type="var">value</span></span> is a syntactic concept &mdash; it is a defined by
      looking at the form of a term &mdash; while <span class="inlinecode"><span class="id" type="var">normal_form</span></span> is a
      semantic one &mdash; it is defined by looking at how the term steps.
      It is not obvious that these concepts should coincide!

<div class="paragraph"> </div>


</li>
<li> Indeed, there are lots of languages in which the concepts of
      normal form and value do <i>not</i> coincide. 
</li>
</ul>

<div class="paragraph"> </div>

 Let's examine how this can happen... 
<div class="paragraph"> </div>

 We might, for example, mistakenly define <span class="inlinecode"><span class="id" type="var">value</span></span> so that it
    includes some terms that are not finished reducing. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="Temp1"><span class="id" type="module">Temp1</span></a>.<br/>
<span class="comment">(*&nbsp;Open&nbsp;an&nbsp;inner&nbsp;module&nbsp;so&nbsp;we&nbsp;can&nbsp;redefine&nbsp;value&nbsp;and&nbsp;step.&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp1.value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#Temp1.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
| <a name="Temp1.v_const"><span class="id" type="constructor">v_const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#Temp1.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>)<br/>
| <a name="Temp1.v_funny"><span class="id" type="constructor">v_funny</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">n2</span>,                       <span class="comment">(*&nbsp;&lt;----&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> (<a class="idref" href="Smallstep.html#Temp1.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>)).<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp1.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Temp1.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Temp1.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp1.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#Temp1.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#Temp1.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>) <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp1.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="Temp1.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Temp1.ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp1.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp1.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2'</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab448"></a><h4 class="section">Exercise: 3 stars, recommended (value_not_same_as_normal_form)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="Temp1.value_not_same_as_normal_form"><span class="id" type="lemma">value_not_same_as_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">t</span>, <a class="idref" href="Smallstep.html#Temp1.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&and;</span> ~ <a class="idref" href="Smallstep.html#Temp1.normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#Temp1.step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">Temp1</span></a>.<br/>

<br/>
</div>

<div class="doc">
Alternatively, we might mistakenly define <span class="inlinecode"><span class="id" type="var">step</span></span> so that it
    permits something designated as a value to reduce further. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="Temp2"><span class="id" type="module">Temp2</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp2.value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#Temp2.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
| <a name="Temp2.v_const"><span class="id" type="constructor">v_const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>).<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp2.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Temp2.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Temp2.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp2.ST_Funny"><span class="id" type="constructor">ST_Funny</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>,                         <span class="comment">(*&nbsp;&lt;----&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>) (<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> 0)<br/>
&nbsp;&nbsp;| <a name="Temp2.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>) <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp2.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="Temp2.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Temp2.ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp2.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp2.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2'</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab449"></a><h4 class="section">Exercise: 3 stars, recommended (value_not_same_as_normal_form)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="Temp2.value_not_same_as_normal_form"><span class="id" type="lemma">value_not_same_as_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">t</span>, <a class="idref" href="Smallstep.html#Temp2.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&and;</span> ~ <a class="idref" href="Smallstep.html#Temp2.normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#Temp2.step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">Temp2</span></a>.<br/>

<br/>
</div>

<div class="doc">
Finally, we might mistakenly define <span class="inlinecode"><span class="id" type="var">value</span></span> and <span class="inlinecode"><span class="id" type="var">step</span></span> so that
    there is some term that is not a value but that cannot take a step
    in the <span class="inlinecode"><span class="id" type="var">step</span></span> relation.  Such terms are said to be <i>stuck</i>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="Temp3"><span class="id" type="module">Temp3</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp3.value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#Temp3.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp3.v_const"><span class="id" type="constructor">v_const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#Temp3.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>).<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp3.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Temp3.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Temp3.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp3.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp3.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#Temp3.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#Temp3.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>) <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp3.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="Temp3.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp3.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp3.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
(Note that <span class="inlinecode"><span class="id" type="var">ST_Plus2</span></span> is missing.) 
<div class="paragraph"> </div>

<a name="lab450"></a><h4 class="section">Exercise: 3 stars (value_not_same_as_normal_form')</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="Temp3.value_not_same_as_normal_form"><span class="id" type="lemma">value_not_same_as_normal_form</span></a> :<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">t</span>, ~ <a class="idref" href="Smallstep.html#Temp3.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&and;</span> <a class="idref" href="Smallstep.html#Temp3.normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#Temp3.step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">Temp3</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab451"></a><h2 class="section">Exercises</h2>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Module</span> <a name="Temp4"><span class="id" type="module">Temp4</span></a>.<br/>

<br/>
</div>

<div class="doc">
Here is another very simple language whose terms, instead of being
    just plus and numbers, are just the booleans true and false and a
    conditional expression... 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp4.tm"><span class="id" type="inductive">tm</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp4.value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#Temp4.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp4.v_true"><span class="id" type="constructor">v_true</span></a> : <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a><br/>
&nbsp;&nbsp;| <a name="Temp4.v_false"><span class="id" type="constructor">v_false</span></a> : <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a>.<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp4.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Temp4.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Temp4.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp4.ST_IfTrue"><span class="id" type="constructor">ST_IfTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1</span><br/>
&nbsp;&nbsp;| <a name="Temp4.ST_IfFalse"><span class="id" type="constructor">ST_IfFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Temp4.ST_If"><span class="id" type="constructor">ST_If</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab452"></a><h4 class="section">Exercise: 1 star (smallstep_bools)</h4>
 Which of the following propositions are provable?  (This is just a
    thought exercise, but for an extra challenge feel free to prove
    your answers in Coq.) 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="Temp4.bool_step_prop1"><span class="id" type="definition">bool_step_prop1</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Temp4.bool_step_prop2"><span class="id" type="definition">bool_step_prop2</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a>)<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Temp4.bool_step_prop3"><span class="id" type="definition">bool_step_prop3</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a><br/>
&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.tm_true"><span class="id" type="constructor">tm_true</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.tm_false"><span class="id" type="constructor">tm_false</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab453"></a><h4 class="section">Exercise: 3 stars, recommended (progress_bool)</h4>
 Just as we proved a progress theorem for plus expressions, we can
    do so for boolean expressions, as well. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Temp4.strong_progress"><span class="id" type="lemma">strong_progress</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t</span> <span style="font-family: arial;">&or;</span> (<span style="font-family: arial;">&exist;</span> <span class="id" type="var">t'</span>, <span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t'</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab454"></a><h4 class="section">Exercise: 2 stars, optional (step_deterministic)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Theorem</span> <a name="Temp4.step_deterministic"><span class="id" type="lemma">step_deterministic</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="SfLib.html#partial_function"><span class="id" type="definition">partial_function</span></a> <a class="idref" href="Smallstep.html#Temp4.step"><span class="id" type="inductive">step</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="Temp4.Temp5"><span class="id" type="module">Temp5</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab455"></a><h4 class="section">Exercise: 2 stars (smallstep_bool_shortcut)</h4>
 Suppose we want to add a "short circuit" to the step relation for
    boolean expressions, so that it can recognize when the <span class="inlinecode"><span class="id" type="keyword">then</span></span> and
    <span class="inlinecode"><span class="id" type="keyword">else</span></span> branches of a conditional are the same value (either
    <span class="inlinecode"><span class="id" type="var">tm_true</span></span> or <span class="inlinecode"><span class="id" type="var">tm_false</span></span>) and reduce the whole conditional to this
    value in a single step, even if the guard has not yet been reduced
    to a value. For example, we would like this proposition to be
    provable: 

<div class="paragraph"> </div>

<div class="code code-tight">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tm_if</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tm_if</span>&nbsp;<span class="id" type="var">tm_true</span>&nbsp;<span class="id" type="var">tm_true</span>&nbsp;<span class="id" type="var">tm_true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tm_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tm_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span>&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tm_false</span>.
<div class="paragraph"> </div>

</div>

<div class="paragraph"> </div>

 Write an extra clause for the step relation that achieves this
    effect and prove <span class="inlinecode"><span class="id" type="var">bool_step_prop4</span></span>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Temp4.Temp5.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Temp4.Temp5.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Temp4.Temp5.ST_IfTrue"><span class="id" type="constructor">ST_IfTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_true"><span class="id" type="constructor">tm_true</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1</span><br/>
&nbsp;&nbsp;| <a name="Temp4.Temp5.ST_IfFalse"><span class="id" type="constructor">ST_IfFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_false"><span class="id" type="constructor">tm_false</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Temp4.Temp5.ST_If"><span class="id" type="constructor">ST_If</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span><br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="Temp4.Temp5.bool_step_prop4"><span class="id" type="definition">bool_step_prop4</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_true"><span class="id" type="constructor">tm_true</span></a> <a class="idref" href="Smallstep.html#Temp4.Temp5.tm_true"><span class="id" type="constructor">tm_true</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_false"><span class="id" type="constructor">tm_false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_false"><span class="id" type="constructor">tm_false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.tm_false"><span class="id" type="constructor">tm_false</span></a>.<br/>

<br/>
<span class="id" type="keyword">Example</span> <a name="Temp4.Temp5.bool_step_prop4_holds"><span class="id" type="definition">bool_step_prop4_holds</span></a> : <br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Temp4.Temp5.bool_step_prop4"><span class="id" type="definition">bool_step_prop4</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab456"></a><h4 class="section">Exercise: 3 stars (properties_of_altered_step)</h4>
 It can be shown that the determinism and strong progress theorems
    for the step relation in the lecture notes also hold for the
    definition of step given above.  After we add the clause
    <span class="inlinecode"><span class="id" type="var">ST_ShortCircuit</span></span>...

<div class="paragraph"> </div>

<ul class="doclist">
<li> Is the <span class="inlinecode"><span class="id" type="var">step</span></span> relation still deterministic?  Write yes or no and
      briefly (1 sentence) explain your answer.

<div class="paragraph"> </div>

      Optional: prove your answer correct in Coq.

</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> Does a strong progress theorem hold? Write yes or no and
     briefly (1 sentence) explain your answer.

<div class="paragraph"> </div>

     Optional: prove your answer correct in Coq.

</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> In general, is there any way we could cause strong progress to
     fail if we took away one or more constructors from the original
     step relation? Write yes or no and briefly (1 sentence) explain
     your answer.

</li>
</ul>

<div class="paragraph"> </div>

  <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
 <font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#Temp5"><span class="id" type="module">Temp5</span></a>.<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">Temp4</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab457"></a><h1 class="section">Multi-Step Reduction</h1>

<div class="paragraph"> </div>

 Until now, we've been working with the <i>single-step reduction</i>
    relation <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span>, which formalizes the individual steps of an
    <i>abstract machine</i> for executing programs.  

<div class="paragraph"> </div>

    It is also interesting to use this machine to reduce programs to
    completion &mdash; to find out what final result they yield.  This can
    be formalized as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> First, we define a <i>multi-step reduction relation</i> <span class="inlinecode"><span style="font-family: arial;">&rArr;*</span></span>, which
      relates terms <span class="inlinecode"><span class="id" type="var">t</span></span> and <span class="inlinecode"><span class="id" type="var">t'</span></span> if <span class="inlinecode"><span class="id" type="var">t</span></span> can reach <span class="inlinecode"><span class="id" type="var">t'</span></span> by any number
      of single reduction steps.

<div class="paragraph"> </div>


</li>
<li> Then we define a "result" of a term <span class="inlinecode"><span class="id" type="var">t</span></span> as a normal form that
      <span class="inlinecode"><span class="id" type="var">t</span></span> can reach by multi-step reduction. 
</li>
</ul>

<div class="paragraph"> </div>

<a name="lab458"></a><h2 class="section">Multi-Step Reduction</h2>

<div class="paragraph"> </div>

 The <i>multi-step reduction</i> relation <span class="inlinecode"><span style="font-family: arial;">&rArr;*</span></span> is the reflexive,
    transitive closure of the single-step relation <span class="inlinecode"><span style="font-family: arial;">&rArr;</span></span>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="stepmany"><span class="id" type="definition">stepmany</span></a> := <a class="idref" href="SfLib.html#refl_step_closure"><span class="id" type="inductive">refl_step_closure</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> " t '<span style="font-family: arial;">&rArr;*</span>' t' " := (<a class="idref" href="Smallstep.html#stepmany"><span class="id" type="definition">stepmany</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
</div>

<div class="doc">
For example... 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="test_stepmany_1"><span class="id" type="lemma">test_stepmany_1</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 2) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 4))<br/>
&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;*</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> (<span class="id" type="definition">plus</span> 0 3) (<span class="id" type="definition">plus</span> 2 4)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 0 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 2) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 4))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 0 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 2 4))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_R"><span class="id" type="lemma">rsc_R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Here's an alternate proof that uses <span class="inlinecode"><span class="id" type="tactic">eapply</span></span> to avoid explicitly
    constructing all the intermediate terms. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="test_stepmany_1'"><span class="id" type="lemma">test_stepmany_1'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 2) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 4))<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&rArr;*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> (<span class="id" type="definition">plus</span> 0 3) (<span class="id" type="definition">plus</span> 2 4)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab459"></a><h4 class="section">Exercise: 1 star (test_stepmany_2)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="test_stepmany_2"><span class="id" type="lemma">test_stepmany_2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3 <span style="font-family: arial;">&rArr;*</span> <a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab460"></a><h4 class="section">Exercise: 1 star (test_stepmany_3)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="test_stepmany_3"><span class="id" type="lemma">test_stepmany_3</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3)<br/>
&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab461"></a><h4 class="section">Exercise: 2 stars (test_stepmany_4)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="test_stepmany_4"><span class="id" type="lemma">test_stepmany_4</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 3)))<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&rArr;*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> 2 (<span class="id" type="definition">plus</span> 0 3))).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab462"></a><h2 class="section">Normal Forms Again</h2>

<div class="paragraph"> </div>

 If <span class="inlinecode"><span class="id" type="var">t</span></span> reduces to <span class="inlinecode"><span class="id" type="var">t'</span></span> in zero or more steps and <span class="inlinecode"><span class="id" type="var">t'</span></span> is a
    normal form, we say that "<span class="inlinecode"><span class="id" type="var">t'</span></span> is a normal form of <span class="inlinecode"><span class="id" type="var">t</span></span>." 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="step_normal_form"><span class="id" type="definition">step_normal_form</span></a> := <a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="normal_form_of"><span class="id" type="definition">normal_form_of</span></a> (<span class="id" type="var">t</span> <span class="id" type="var">t'</span> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a>) :=<br/>
&nbsp;&nbsp;(<span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">t'</span> <span style="font-family: arial;">&and;</span> <a class="idref" href="Smallstep.html#step_normal_form"><span class="id" type="definition">step_normal_form</span></a> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
We have already seen that single-step reduction is
    deterministic &mdash; i.e., a given term can take a single step in
    at most one way.  It follows from this that, if <span class="inlinecode"><span class="id" type="var">t</span></span> can reach
    a normal form, then this normal form is unique &mdash; i.e.,
    <span class="inlinecode"><span class="id" type="var">normal_form_of</span></span> is a partial function.  In other words, we
    can actually pronounce <span class="inlinecode"><span class="id" type="var">normal_form</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> as "<span class="inlinecode"><span class="id" type="var">t'</span></span> is <i>the</i>
    normal form of <span class="inlinecode"><span class="id" type="var">t</span></span>." 
<div class="paragraph"> </div>

<a name="lab463"></a><h4 class="section">Exercise: 3 stars, optional (test_stepmany_3)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Theorem</span> <a name="normal_forms_unique"><span class="id" type="lemma">normal_forms_unique</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="SfLib.html#partial_function"><span class="id" type="definition">partial_function</span></a> <a class="idref" href="Smallstep.html#normal_form_of"><span class="id" type="definition">normal_form_of</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">partial_function</span>. <span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form_of</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">P1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">P11</span> <span class="id" type="var">P12</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">P2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">P21</span> <span class="id" type="var">P22</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">y2</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;recommend&nbsp;using&nbsp;this&nbsp;initial&nbsp;setup&nbsp;as-is!&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 Indeed, something stronger is true for this language (though not
    for all languages): the reduction of <i>any</i> term <span class="inlinecode"><span class="id" type="var">t</span></span> will
    eventually reach a normal form &mdash; i.e., <span class="inlinecode"><span class="id" type="var">normal_form_of</span></span> is a
    <i>total</i> function.  Formally, we say the <span class="inlinecode"><span class="id" type="var">step</span></span> relation is
    <i>normalizing</i>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="normalizing"><span class="id" type="definition">normalizing</span></a> {<span class="id" type="var">X</span>:<span class="id" type="keyword">Type</span>} (<span class="id" type="var">R</span>:<span class="id" type="definition">relation</span> <span class="id" type="var">X</span>) :=<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span>, <span style="font-family: arial;">&exist;</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="SfLib.html#refl_step_closure"><span class="id" type="inductive">refl_step_closure</span></a> <span class="id" type="var">R</span>) <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span style="font-family: arial;">&and;</span> <a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <span class="id" type="var">R</span> <span class="id" type="var">t'</span>.<br/>

<br/>
</div>

<div class="doc">
To prove that <span class="inlinecode"><span class="id" type="var">step</span></span> is normalizing, we need a couple of lemmas.

<div class="paragraph"> </div>

    First, we observe that, if <span class="inlinecode"><span class="id" type="var">t</span></span> reduces to <span class="inlinecode"><span class="id" type="var">t'</span></span> in many steps, then
    the same sequence of reduction steps within <span class="inlinecode"><span class="id" type="var">t</span></span> is also possible
    when <span class="inlinecode"><span class="id" type="var">t</span></span> appears as the left-hand child of a <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> node, and
    similarly when <span class="inlinecode"><span class="id" type="var">t</span></span> appears as the right-hand child of a <span class="inlinecode"><span class="id" type="var">tm_plus</span></span>
    node (whose left-hand child is a value). 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="stepmany_congr_1"><span class="id" type="lemma">stepmany_congr_1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;*</span> <a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">H</span>. <span class="id" type="var">rsc_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>) <span class="id" type="var">Case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "rsc_refl". <span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "rsc_step". <span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">y</span> <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHrefl_step_closure</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab464"></a><h4 class="section">Exercise: 2 stars</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="stepmany_congr_2"><span class="id" type="lemma">stepmany_congr_2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;*</span> <a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 <i>Theorem</i>: The <span class="inlinecode"><span class="id" type="var">step</span></span> function is normalizing &mdash; i.e., for every
    <span class="inlinecode"><span class="id" type="var">t</span></span> there exists some <span class="inlinecode"><span class="id" type="var">t'</span></span> such that <span class="inlinecode"><span class="id" type="var">t</span></span> steps to <span class="inlinecode"><span class="id" type="var">t'</span></span> and <span class="inlinecode"><span class="id" type="var">t'</span></span> is
    a normal form.

<div class="paragraph"> </div>

    <i>Proof sketch</i>: By induction on terms.  There are two cases to
    consider:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n</span></span> for some <span class="inlinecode"><span class="id" type="var">n</span></span>.  Here <span class="inlinecode"><span class="id" type="var">t</span></span> doesn't take a step,
      and we have <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">t</span></span>.  We can derive the left-hand side by
      reflexivity and the right-hand side by observing (a) that values
      are normal forms (by <span class="inlinecode"><span class="id" type="var">nf_same_as_value</span></span>) and (b) that <span class="inlinecode"><span class="id" type="var">t</span></span> is a
      value (by <span class="inlinecode"><span class="id" type="var">v_const</span></span>).

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> for some <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span>.  By the IH, <span class="inlinecode"><span class="id" type="var">t1</span></span> and
      <span class="inlinecode"><span class="id" type="var">t2</span></span> have normal forms <span class="inlinecode"><span class="id" type="var">t1'</span></span> and <span class="inlinecode"><span class="id" type="var">t2'</span></span>.  Recall that normal
      forms are values (by <span class="inlinecode"><span class="id" type="var">nf_same_as_value</span></span>); we know that <span class="inlinecode"><span class="id" type="var">t1'</span></span> <span class="inlinecode">=</span>
      <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n1</span></span> and <span class="inlinecode"><span class="id" type="var">t2'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode"><span class="id" type="var">n2</span></span>, for some <span class="inlinecode"><span class="id" type="var">n1</span></span> and <span class="inlinecode"><span class="id" type="var">n2</span></span>.
      We can combine the <span class="inlinecode"><span style="font-family: arial;">&rArr;*</span></span> derivations for <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> to prove
      that <span class="inlinecode"><span class="id" type="var">tm_plus</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> reduces in many steps to <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode">(<span class="id" type="var">plus</span></span> <span class="inlinecode"><span class="id" type="var">n1</span></span>
      <span class="inlinecode"><span class="id" type="var">n2</span>)</span>.

<div class="paragraph"> </div>

      It is clear that our choice of <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">tm_const</span></span> <span class="inlinecode">(<span class="id" type="var">plus</span></span> <span class="inlinecode"><span class="id" type="var">n1</span></span> <span class="inlinecode"><span class="id" type="var">n2</span>)</span> is a
      value, which is in turn a normal form. <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="step_normalizing"><span class="id" type="lemma">step_normalizing</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#normalizing"><span class="id" type="definition">normalizing</span></a> <a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normalizing</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>) <span class="id" type="var">Case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tm_const".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "l". <span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "r".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can&nbsp;use&nbsp;<span class="inlinecode"><span class="id" type="tactic">rewrite</span></span>&nbsp;with&nbsp;"iff"&nbsp;statements,&nbsp;not<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just&nbsp;equalities:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tm_plus".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t1'</span> <span class="id" type="var">H1</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t2'</span> <span class="id" type="var">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H11</span> <span class="id" type="var">H12</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H21</span> <span class="id" type="var">H22</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H12</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H22</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H12</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">n1</span>]. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H22</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">n2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span style="font-family: arial;">&larr;</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "l".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_trans"><span class="id" type="axiom">rsc_trans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#stepmany_congr_1"><span class="id" type="lemma">stepmany_congr_1</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_trans"><span class="id" type="axiom">rsc_trans</span></a> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#stepmany_congr_2"><span class="id" type="axiom">stepmany_congr_2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_R"><span class="id" type="lemma">rsc_R</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "r".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab465"></a><h2 class="section">Equivalence of Big-Step and Small-Step Reduction</h2>

<div class="paragraph"> </div>

 Having defined the operational semantics of our tiny programming
    language in two different styles, it makes sense to ask whether
    these definitions actually define the same thing!  They do, but it
    is not completely straightforward to show this &mdash; or even to see
    how to state it exactly, since one of the relations only goes a
    small step at a time while the other proceeds in large chunks. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="eval__value"><span class="id" type="lemma">eval__value</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#eval"><span class="id" type="inductive">eval</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">t2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">HE</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_cases</span> (<span class="id" type="tactic">inversion</span> <span class="id" type="var">HE</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#v_const"><span class="id" type="constructor">v_const</span></a>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab466"></a><h4 class="section">Exercise: 3 stars (eval__stepmany)</h4>
 You'll want to use the congruences and some properties of
    <span class="inlinecode"><span class="id" type="var">rsc</span></span> for this. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="eval__stepmany"><span class="id" type="lemma">eval__stepmany</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#eval"><span class="id" type="inductive">eval</span></a> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span style="font-family: arial;">&rarr;</span> <span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab467"></a><h4 class="section">Exercise: 3 stars (eval__stepmany_inf)</h4>
 Write an informal version of the proof of eval__stepmany.

<div class="paragraph"> </div>

<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<font size=-2>&#9744;</font>

<div class="paragraph"> </div>

<a name="lab468"></a><h4 class="section">Exercise: 3 stars (step__eval)</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Theorem</span> <a name="step__eval"><span class="id" type="lemma">step__eval</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t'</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">v</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="stepmany__eval"><span class="id" type="lemma">stepmany__eval</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#normal_form_of"><span class="id" type="definition">normal_form_of</span></a> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span style="font-family: arial;">&rarr;</span> <span class="id" type="var">t</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnorm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form_of</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hnorm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hnorm</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hs</span> <span class="id" type="var">Hnf</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hnorm</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;v&nbsp;is&nbsp;a&nbsp;normal&nbsp;form&nbsp;-&gt;&nbsp;v&nbsp;=&nbsp;tm_const&nbsp;n&nbsp;for&nbsp;some&nbsp;n&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">clear</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">rsc_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">Hs</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "rsc_refl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#E_Const"><span class="id" type="constructor">E_Const</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "rsc_step".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Smallstep.html#step__eval"><span class="id" type="axiom">step__eval</span></a>. <span class="id" type="var">eassumption</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHHs</span>. <span class="id" type="tactic">reflexivity</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Bringing it all together, we can crisply say that the <span class="inlinecode"><span class="id" type="var">v</span></span> is the
    normal form of <span class="inlinecode"><span class="id" type="var">t</span></span> iff <span class="inlinecode"><span class="id" type="var">t</span></span> evaluates to <span class="inlinecode"><span class="id" type="var">v</span></span>. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Corollary</span> <a name="stepmany_iff_eval"><span class="id" type="lemma">stepmany_iff_eval</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#normal_form_of"><span class="id" type="definition">normal_form_of</span></a> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span style="font-family: arial;">&harr;</span> <span class="id" type="var">t</span> <span style="font-family: arial;">&dArr;</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "<span style="font-family: arial;">&rarr;</span>". <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#stepmany__eval"><span class="id" type="lemma">stepmany__eval</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "<span style="font-family: arial;">&larr;</span>". <span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form_of</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">E</span>. <span class="id" type="tactic">split</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#eval__stepmany"><span class="id" type="axiom">eval__stepmany</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Smallstep.html#nf_same_as_value"><span class="id" type="lemma">nf_same_as_value</span></a>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Smallstep.html#eval__value"><span class="id" type="lemma">eval__value</span></a>. <span class="id" type="var">eassumption</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab469"></a><h2 class="section">Additional Exercises</h2>

<div class="paragraph"> </div>

<a name="lab470"></a><h4 class="section">Exercise: 4 stars (combined_properties)</h4>
 We've considered the arithmetic and conditional expressions
    separately.  This exercise explores how the two interact. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="Combined"><span class="id" type="module">Combined</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Combined.tm"><span class="id" type="inductive">tm</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="Combined.tm_const"><span class="id" type="constructor">tm_const</span></a> : <span class="id" type="inductive">nat</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Combined.tm_true"><span class="id" type="constructor">tm_true</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Combined.tm_false"><span class="id" type="constructor">tm_false</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="Combined.tm_if"><span class="id" type="constructor">tm_if</span></a> : <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#tm"><span class="id" type="inductive">tm</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "tm_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_const" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_plus"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_true" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_false" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tm_if" ].<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Combined.value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Smallstep.html#Combined.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Combined.v_const"><span class="id" type="constructor">v_const</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Smallstep.html#Combined.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;| <a name="Combined.v_true"><span class="id" type="constructor">v_true</span></a> : <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Smallstep.html#Combined.tm_true"><span class="id" type="constructor">tm_true</span></a><br/>
&nbsp;&nbsp;| <a name="Combined.v_false"><span class="id" type="constructor">v_false</span></a> : <a class="idref" href="Smallstep.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Smallstep.html#Combined.tm_false"><span class="id" type="constructor">tm_false</span></a>.<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Combined.step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Smallstep.html#Combined.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#Combined.tm"><span class="id" type="inductive">tm</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Combined.ST_PlusConstConst"><span class="id" type="constructor">ST_PlusConstConst</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> (<a class="idref" href="Smallstep.html#Combined.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Smallstep.html#Combined.tm_const"><span class="id" type="constructor">tm_const</span></a> <span class="id" type="var">n2</span>) <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Combined.tm_const"><span class="id" type="constructor">tm_const</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="Combined.ST_Plus1"><span class="id" type="constructor">ST_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Combined.ST_Plus2"><span class="id" type="constructor">ST_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.value"><span class="id" type="inductive">value</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span>     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Combined.tm_plus"><span class="id" type="constructor">tm_plus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">t2'</span><br/>
&nbsp;&nbsp;| <a name="Combined.ST_IfTrue"><span class="id" type="constructor">ST_IfTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Combined.tm_true"><span class="id" type="constructor">tm_true</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1</span><br/>
&nbsp;&nbsp;| <a name="Combined.ST_IfFalse"><span class="id" type="constructor">ST_IfFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_if"><span class="id" type="constructor">tm_if</span></a> <a class="idref" href="Smallstep.html#Combined.tm_false"><span class="id" type="constructor">tm_false</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;| <a name="Combined.ST_If"><span class="id" type="constructor">ST_If</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t1</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">t1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#Combined.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span style="font-family: arial;">&rArr;</span> <a class="idref" href="Smallstep.html#Combined.tm_if"><span class="id" type="constructor">tm_if</span></a> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '<span style="font-family: arial;">&rArr;</span>' t' " := (<a class="idref" href="Smallstep.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "step_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_PlusConstConst"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus1" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Plus2"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_IfTrue" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_IfFalse" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_If" ].<br/>

<br/>
</div>

<div class="doc">
Earlier, we separately proved for both plus- and if-expressions...

<div class="paragraph"> </div>

<ul class="doclist">
<li> that the step relation was a partial function (i.e., it was
      deterministic), and

<div class="paragraph"> </div>


</li>
<li> a strong progress lemma, stating that every term is either a
      value or can take a step.

</li>
</ul>
    Prove or disprove these for the combined language. 
</div>
<div class="code code-tight">

<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code code-tight">
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">Combined</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab471"></a><h1 class="section">Small-Step Imp</h1>

<div class="paragraph"> </div>

 For a more serious example, here is the small-step version of the
    Imp operational semantics.  Although the definitions are bigger,
    the basic ideas are exactly the same as what we've seen above. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="aval"><span class="id" type="inductive">aval</span></a> : <a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="av_num"><span class="id" type="constructor">av_num</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n</span>).<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>a' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40, <span class="id" type="var">st</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="astep"><span class="id" type="inductive">astep</span></a> : <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="AS_Id"><span class="id" type="constructor">AS_Id</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">i</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#AId"><span class="id" type="constructor">AId</span></a> <span class="id" type="var">i</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> (<span class="id" type="var">st</span> <span class="id" type="var">i</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Plus"><span class="id" type="constructor">AS_Plus</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> (<span class="id" type="definition">plus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Plus1"><span class="id" type="constructor">AS_Plus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">a1</span> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Plus2"><span class="id" type="constructor">AS_Plus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2'</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Minus"><span class="id" type="constructor">AS_Minus</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n2</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> (<span class="id" type="definition">minus</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>))<br/>
&nbsp;&nbsp;| <a name="AS_Minus1"><span class="id" type="constructor">AS_Minus1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">a1</span> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Minus2"><span class="id" type="constructor">AS_Minus2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2'</span>)<br/>
&nbsp;&nbsp;| <a name="AS_Mult"><span class="id" type="constructor">AS_Mult</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n2</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> (<span class="id" type="definition">mult</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>))<br/>
&nbsp;&nbsp;| <a name="AS_Mult1"><span class="id" type="constructor">AS_Mult1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">a1</span> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> (<span class="id" type="var">a1</span>) (<span class="id" type="var">a2</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> (<span class="id" type="var">a1'</span>) (<span class="id" type="var">a2</span>))<br/>
&nbsp;&nbsp;| <a name="AS_Mult2"><span class="id" type="constructor">AS_Mult2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> (<a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2'</span>)<br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>a' t' " := (<a class="idref" href="Smallstep.html#astep"><span class="id" type="inductive">astep</span></a> <span class="id" type="var">st</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>b' t' " (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40, <span class="id" type="var">st</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="bstep"><span class="id" type="inductive">bstep</span></a> : <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Imp.html#bexp"><span class="id" type="inductive">bexp</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Imp.html#bexp"><span class="id" type="inductive">bexp</span></a> <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="BS_Eq"><span class="id" type="constructor">BS_Eq</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n2</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">if</span> (<span class="id" type="definition">beq_nat</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>) <span class="id" type="keyword">then</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="keyword">else</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>)<br/>
&nbsp;&nbsp;| <a name="BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">a1</span> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>)<br/>
&nbsp;&nbsp;| <a name="BS_Eq2"><span class="id" type="constructor">BS_Eq2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2'</span>)<br/>
&nbsp;&nbsp;| <a name="BS_LtEq"><span class="id" type="constructor">BS_LtEq</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n1</span>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n2</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">if</span> (<a class="idref" href="SfLib.html#ble_nat"><span class="id" type="definition">ble_nat</span></a> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>) <span class="id" type="keyword">then</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="keyword">else</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>)<br/>
&nbsp;&nbsp;| <a name="BS_LtEq1"><span class="id" type="constructor">BS_LtEq1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">a1</span> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">a1'</span> <span class="id" type="var">a2</span>)<br/>
&nbsp;&nbsp;| <a name="BS_LtEq2"><span class="id" type="constructor">BS_LtEq2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#aval"><span class="id" type="inductive">aval</span></a> <span class="id" type="var">v1</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">v1</span> <span class="id" type="var">a2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">v1</span> (<span class="id" type="var">a2'</span>))<br/>
&nbsp;&nbsp;| <a name="BS_NotTrue"><span class="id" type="constructor">BS_NotTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a><br/>
&nbsp;&nbsp;| <a name="BS_NotFalse"><span class="id" type="constructor">BS_NotFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a><br/>
&nbsp;&nbsp;| <a name="BS_NotStep"><span class="id" type="constructor">BS_NotStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b1</span> <span class="id" type="var">b1'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <span class="id" type="var">b1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <span class="id" type="var">b1</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <span class="id" type="var">b1'</span>)<br/>
&nbsp;&nbsp;| <a name="BS_AndTrueTrue"><span class="id" type="constructor">BS_AndTrueTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a><br/>
&nbsp;&nbsp;| <a name="BS_AndTrueFalse"><span class="id" type="constructor">BS_AndTrueFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a><br/>
&nbsp;&nbsp;| <a name="BS_AndFalse"><span class="id" type="constructor">BS_AndFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a> <span class="id" type="var">b2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a><br/>
&nbsp;&nbsp;| <a name="BS_AndTrueStep"><span class="id" type="constructor">BS_AndTrueStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b2</span> <span class="id" type="var">b2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <span class="id" type="var">b2'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="var">b2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="var">b2'</span>)<br/>
&nbsp;&nbsp;| <a name="BS_AndStep"><span class="id" type="constructor">BS_AndStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b1</span> <span class="id" type="var">b1'</span> <span class="id" type="var">b2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <span class="id" type="var">b1'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <span class="id" type="var">b1</span> <span class="id" type="var">b2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> (<a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <span class="id" type="var">b1'</span> <span class="id" type="var">b2</span>)<br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>b' t' " := (<a class="idref" href="Smallstep.html#bstep"><span class="id" type="inductive">bstep</span></a> <span class="id" type="var">st</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
Notice that we didn't actually bother to define boolean values &mdash;
    they aren't needed in the definition of <span class="inlinecode"><span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span></span> (why?), though
    they might be if our language were a bit larger. 
<div class="paragraph"> </div>

 The semantics of commands is the interesting part.  We need two
    small tricks to make it work:

<div class="paragraph"> </div>

<ul class="doclist">
<li> We use <span class="inlinecode"><span class="id" type="var">SKIP</span></span> as a "command value" &mdash; i.e., a command that
         has reached a normal form.  

<div class="paragraph"> </div>

<ul class="doclist">
<li> An assignment command reduces to <span class="inlinecode"><span class="id" type="var">SKIP</span></span> (and an updated
              state).

<div class="paragraph"> </div>


</li>
<li> The sequencing command waits until its left-hand
              subcommand has reduced to <span class="inlinecode"><span class="id" type="var">SKIP</span></span>, then throws it away so
              that reduction can continue with the right-hand
              subcommand.

<div class="paragraph"> </div>


</li>
</ul>

</li>
<li> We reduce a <span class="inlinecode"><span class="id" type="var">WHILE</span></span> command by transforming it into a
         conditional followed by the same <span class="inlinecode"><span class="id" type="var">WHILE</span></span>.  

<div class="paragraph"> </div>

         (There are other ways of achieving the desired effect, but
         they all share the feature that the original <span class="inlinecode"><span class="id" type="var">WHILE</span></span> command
         needs to be saved somewhere while a single copy of the loop
         body is being evaluated.) 
</li>
</ul>

</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Reserved Notation</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>' t' '/' st' " <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40, <span class="id" type="var">st</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39, <span class="id" type="var">t'</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="cstep"><span class="id" type="inductive">cstep</span></a> : (<a class="idref" href="Imp.html#com"><span class="id" type="inductive">com</span></a> * <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a>) <span style="font-family: arial;">&rarr;</span> (<a class="idref" href="Imp.html#com"><span class="id" type="inductive">com</span></a> * <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a>) <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i</span> ::= <span class="id" type="var">a</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">i</span> ::= <span class="id" type="var">a'</span>) / <span class="id" type="var">st</span> <br/>
&nbsp;&nbsp;| <a name="CS_Ass"><span class="id" type="constructor">CS_Ass</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i</span> ::= (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">SKIP</span> / (<a class="idref" href="Imp.html#update"><span class="id" type="definition">update</span></a> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;| <a name="CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c1'</span> <span class="id" type="var">st'</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">c1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c1'</span> / <span class="id" type="var">st'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">c1</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">c1'</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;| <a name="CS_SeqFinish"><span class="id" type="constructor">CS_SeqFinish</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">SKIP</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c2</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CS_IfTrue"><span class="id" type="constructor">CS_IfTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">IFB</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c1</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CS_IfFalse"><span class="id" type="constructor">CS_IfFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">IFB</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c2</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <span class="id" type="var">b'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">IFB</span> <span class="id" type="var">b</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">IFB</span> <span class="id" type="var">b'</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CS_While"><span class="id" type="constructor">CS_While</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b</span> <span class="id" type="var">c1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">WHILE</span> <span class="id" type="var">b</span> <span class="id" type="var">DO</span> <span class="id" type="var">c1</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">IFB</span> <span class="id" type="var">b</span> <span class="id" type="var">THEN</span> (<span class="id" type="var">c1</span>; (<span class="id" type="var">WHILE</span> <span class="id" type="var">b</span> <span class="id" type="var">DO</span> <span class="id" type="var">c1</span> <span class="id" type="var">END</span>)) <span class="id" type="var">ELSE</span> <span class="id" type="var">SKIP</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>' t' '/' st' " := (<a class="idref" href="Smallstep.html#cstep"><span class="id" type="inductive">cstep</span></a> (<span class="id" type="var">t</span>,<span class="id" type="var">st</span>) (<span class="id" type="var">t'</span>,<span class="id" type="var">st'</span>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab472"></a><h1 class="section">Concurrent Imp</h1>

<div class="paragraph"> </div>

 Finally, to show the power of this definitional style, let's
    enrich Imp with a new form of command that runs two subcommands in
    parallel and terminates when both have terminated.  To reflect the
    unpredictability of scheduling, the actions of the subcommands may
    be interleaved in any order, but they share the same memory and
    can communicate by reading and writing the same variables. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Module</span> <a name="CImp"><span class="id" type="module">CImp</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="CImp.com"><span class="id" type="inductive">com</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="CImp.CSkip"><span class="id" type="constructor">CSkip</span></a> : <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a name="CImp.CAss"><span class="id" type="constructor">CAss</span></a> : <a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a name="CImp.CSeq"><span class="id" type="constructor">CSeq</span></a> : <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a name="CImp.CIf"><span class="id" type="constructor">CIf</span></a> : <a class="idref" href="Imp.html#bexp"><span class="id" type="inductive">bexp</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a name="CImp.CWhile"><span class="id" type="constructor">CWhile</span></a> : <a class="idref" href="Imp.html#bexp"><span class="id" type="inductive">bexp</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;New:&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a name="CImp.CPar"><span class="id" type="constructor">CPar</span></a> : <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="Smallstep.html#com"><span class="id" type="inductive">com</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "com_cases" <span class="id" type="var">tactic</span>(<span class="id" type="var">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "SKIP" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "::=" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> ";"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "IFB" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "WHILE" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "PAR" ].<br/>

<br/>
<span class="id" type="keyword">Notation</span> "'SKIP'" := <br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.CSkip"><span class="id" type="constructor">CSkip</span></a>.<br/>
<span class="id" type="keyword">Notation</span> "l '::=' a" := <br/>
&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#CImp.CAss"><span class="id" type="constructor">CAss</span></a> <span class="id" type="var">l</span> <span class="id" type="var">a</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 60).<br/>
<span class="id" type="keyword">Notation</span> "c1 ; c2" := <br/>
&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#CImp.CSeq"><span class="id" type="constructor">CSeq</span></a> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 80, <span class="id" type="var">right</span> <span class="id" type="var">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> "'WHILE' b 'DO' c 'END'" := <br/>
&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#CImp.CWhile"><span class="id" type="constructor">CWhile</span></a> <span class="id" type="var">b</span> <span class="id" type="var">c</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 80, <span class="id" type="var">right</span> <span class="id" type="var">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> "'IFB' e1 'THEN' e2 'ELSE' e3 'FI'" := <br/>
&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#CImp.CIf"><span class="id" type="constructor">CIf</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span> <span class="id" type="var">e3</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 80, <span class="id" type="var">right</span> <span class="id" type="var">associativity</span>).<br/>
<span class="id" type="keyword">Notation</span> "'PAR' c1 'WITH' c2 'END'" := <br/>
&nbsp;&nbsp;(<a class="idref" href="Smallstep.html#CImp.CPar"><span class="id" type="constructor">CPar</span></a> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 80, <span class="id" type="var">right</span> <span class="id" type="var">associativity</span>).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="CImp.cstep"><span class="id" type="inductive">cstep</span></a> : (<a class="idref" href="Smallstep.html#CImp.com"><span class="id" type="inductive">com</span></a> * <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a>)  <span style="font-family: arial;">&rarr;</span> (<a class="idref" href="Smallstep.html#CImp.com"><span class="id" type="inductive">com</span></a> * <a class="idref" href="Imp.html#state"><span class="id" type="definition">state</span></a>) <span style="font-family: arial;">&rarr;</span> <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="CImp.CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">a</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">a</span> <span class="id" type="var">a'</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i</span> ::= <span class="id" type="var">a</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">i</span> ::= <span class="id" type="var">a'</span>) / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">i</span> ::= (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n</span>)) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">SKIP</span> / (<a class="idref" href="Imp.html#update"><span class="id" type="definition">update</span></a> <span class="id" type="var">st</span> <span class="id" type="var">i</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;| <a name="CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c1'</span> <span class="id" type="var">st'</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">c1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c1'</span> / <span class="id" type="var">st'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">c1</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">c1'</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_SeqFinish"><span class="id" type="constructor">CS_SeqFinish</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">SKIP</span> ; <span class="id" type="var">c2</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c2</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_IfTrue"><span class="id" type="constructor">CS_IfTrue</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IFB</span> <a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c1</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_IfFalse"><span class="id" type="constructor">CS_IfFalse</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IFB</span> <a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c2</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b</span> /<span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span><span class="id" type="var">b</span> <span class="id" type="var">b'</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IFB</span> <span class="id" type="var">b</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">IFB</span> <span class="id" type="var">b'</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c1</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c2</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_While"><span class="id" type="constructor">CS_While</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">b</span> <span class="id" type="var">c1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">WHILE</span> <span class="id" type="var">b</span> <span class="id" type="var">DO</span> <span class="id" type="var">c1</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IFB</span> <span class="id" type="var">b</span> <span class="id" type="var">THEN</span> (<span class="id" type="var">c1</span>; (<span class="id" type="var">WHILE</span> <span class="id" type="var">b</span> <span class="id" type="var">DO</span> <span class="id" type="var">c1</span> <span class="id" type="var">END</span>)) <span class="id" type="var">ELSE</span> <span class="id" type="var">SKIP</span> <span class="id" type="var">FI</span>) / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;New:&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_Par1"><span class="id" type="constructor">CS_Par1</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c1'</span> <span class="id" type="var">c2</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">c1</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c1'</span> / <span class="id" type="var">st'</span> <span style="font-family: arial;">&rarr;</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">PAR</span> <span class="id" type="var">c1</span> <span class="id" type="var">WITH</span> <span class="id" type="var">c2</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">PAR</span> <span class="id" type="var">c1'</span> <span class="id" type="var">WITH</span> <span class="id" type="var">c2</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span> <span class="id" type="var">c1</span> <span class="id" type="var">c2</span> <span class="id" type="var">c2'</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">c2</span> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">c2'</span> / <span class="id" type="var">st'</span> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">PAR</span> <span class="id" type="var">c1</span> <span class="id" type="var">WITH</span> <span class="id" type="var">c2</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> (<span class="id" type="var">PAR</span> <span class="id" type="var">c1</span> <span class="id" type="var">WITH</span> <span class="id" type="var">c2'</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;| <a name="CImp.CS_ParDone"><span class="id" type="constructor">CS_ParDone</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">PAR</span> <span class="id" type="var">SKIP</span> <span class="id" type="var">WITH</span> <span class="id" type="var">SKIP</span> <span class="id" type="var">END</span>) / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;</span> <span class="id" type="var">SKIP</span> / <span class="id" type="var">st</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">where</span> " t '/' st '<span style="font-family: arial;">&rArr;</span>' t' '/' st' " := (<a class="idref" href="Smallstep.html#cstep"><span class="id" type="inductive">cstep</span></a> (<span class="id" type="var">t</span>,<span class="id" type="var">st</span>) (<span class="id" type="var">t'</span>,<span class="id" type="var">st'</span>)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CImp.cstepmany"><span class="id" type="definition">cstepmany</span></a> := <a class="idref" href="SfLib.html#refl_step_closure"><span class="id" type="inductive">refl_step_closure</span></a> <a class="idref" href="Smallstep.html#CImp.cstep"><span class="id" type="inductive">cstep</span></a>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> " t '/' st '<span style="font-family: arial;">&rArr;*</span>' t' '/' st' " := <br/>
&nbsp;&nbsp;&nbsp;(<a class="idref" href="SfLib.html#refl_step_closure"><span class="id" type="inductive">refl_step_closure</span></a> <a class="idref" href="Smallstep.html#CImp.cstep"><span class="id" type="inductive">cstep</span></a>  (<span class="id" type="var">t</span>,<span class="id" type="var">st</span>) (<span class="id" type="var">t'</span>,<span class="id" type="var">st'</span>)) <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 40, <span class="id" type="var">st</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39, <span class="id" type="var">t'</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 39).<br/>

<br/>
</div>

<div class="doc">
Among the many interesting properties of this language is the fact
    that the following program can terminate with the variable <span class="inlinecode"><span class="id" type="var">X</span></span> set
    to any value... 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="CImp.par_loop"><span class="id" type="definition">par_loop</span></a> : <a class="idref" href="Smallstep.html#CImp.com"><span class="id" type="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">PAR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a> ::= <a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> 1<br/>
&nbsp;&nbsp;<span class="id" type="var">WITH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">WHILE</span> <a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> (<a class="idref" href="Imp.html#AId"><span class="id" type="constructor">AId</span></a> <a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> 0) <span class="id" type="var">DO</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> ::= <a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AId"><span class="id" type="constructor">AId</span></a> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a>) (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">END</span><br/>
&nbsp;&nbsp;<span class="id" type="var">END</span>.<br/>

<br/>
</div>

<div class="doc">
In particular, it can terminate with <span class="inlinecode"><span class="id" type="var">X</span></span> set to <span class="inlinecode">0</span>: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Example</span> <a name="CImp.par_loop_example_0"><span class="id" type="definition">par_loop_example_0</span></a>:<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <a class="idref" href="Imp.html#empty_state"><span class="id" type="definition">empty_state</span></a>  <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">SKIP</span> / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&and;</span> <span class="id" type="var">st'</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="constructor">ex_intro</span>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">par_loop</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par1"><span class="id" type="constructor">CS_Par1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_While"><span class="id" type="constructor">CS_While</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq"><span class="id" type="constructor">BS_Eq</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfFalse"><span class="id" type="constructor">CS_IfFalse</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_ParDone"><span class="id" type="constructor">CS_ParDone</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
It can also terminate with <span class="inlinecode"><span class="id" type="var">X</span></span> set to <span class="inlinecode">2</span>: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Example</span> <a name="CImp.par_loop_example_2"><span class="id" type="definition">par_loop_example_2</span></a>:<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <a class="idref" href="Imp.html#empty_state"><span class="id" type="definition">empty_state</span></a> <span style="font-family: arial;">&rArr;*</span> <span class="id" type="var">SKIP</span> / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&and;</span> <span class="id" type="var">st'</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = 2.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="constructor">ex_intro</span>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_While"><span class="id" type="constructor">CS_While</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq"><span class="id" type="constructor">BS_Eq</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfTrue"><span class="id" type="constructor">CS_IfTrue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Plus1"><span class="id" type="constructor">AS_Plus1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Plus"><span class="id" type="constructor">AS_Plus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqFinish"><span class="id" type="constructor">CS_SeqFinish</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_While"><span class="id" type="constructor">CS_While</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq"><span class="id" type="constructor">BS_Eq</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfTrue"><span class="id" type="constructor">CS_IfTrue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Plus1"><span class="id" type="constructor">AS_Plus1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_AssStep"><span class="id" type="constructor">CS_AssStep</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Plus"><span class="id" type="constructor">AS_Plus</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqStep"><span class="id" type="constructor">CS_SeqStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par1"><span class="id" type="constructor">CS_Par1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_SeqFinish"><span class="id" type="constructor">CS_SeqFinish</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_While"><span class="id" type="constructor">CS_While</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq"><span class="id" type="constructor">BS_Eq</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfFalse"><span class="id" type="constructor">CS_IfFalse</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_ParDone"><span class="id" type="constructor">CS_ParDone</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
More generally... 
<div class="paragraph"> </div>

<a name="lab473"></a><h4 class="section">Exercise: 3 stars, optional</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="CImp.par_body_n__Sn"><span class="id" type="lemma">par_body_n__Sn</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">st</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = <span class="id" type="var">n</span> <span style="font-family: arial;">&and;</span> <span class="id" type="var">st</span> <a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a> = 0 <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;*</span> <a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / (<a class="idref" href="Imp.html#update"><span class="id" type="definition">update</span></a> <span class="id" type="var">st</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> (<span class="id" type="constructor">S</span> <span class="id" type="var">n</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab474"></a><h4 class="section">Exercise: 3 stars, optional</h4>

</div>
<div class="code code-space">
<span class="id" type="keyword">Lemma</span> <a name="CImp.par_body_n"><span class="id" type="lemma">par_body_n</span></a> : <span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">st</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = 0 <span style="font-family: arial;">&and;</span> <span class="id" type="var">st</span> <a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a> = 0 <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <span class="id" type="var">st</span> <span style="font-family: arial;">&rArr;*</span>  <a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <span class="id" type="var">st'</span> <span style="font-family: arial;">&and;</span> <span class="id" type="var">st'</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = <span class="id" type="var">n</span> <span style="font-family: arial;">&and;</span> <span class="id" type="var">st'</span> <a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a> = 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
... the above loop can exit with <span class="inlinecode"><span class="id" type="var">X</span></span> having any value
    whatsoever. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="CImp.par_loop_any_X"><span class="id" type="lemma">par_loop_any_X</span></a>:<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&forall;</span> <span class="id" type="var">n</span>, <span style="font-family: arial;">&exist;</span> <span class="id" type="var">st'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a> / <a class="idref" href="Imp.html#empty_state"><span class="id" type="definition">empty_state</span></a> <span style="font-family: arial;">&rArr;*</span>  <span class="id" type="var">SKIP</span> / <span class="id" type="var">st'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: arial;">&and;</span> <span class="id" type="var">st'</span> <a class="idref" href="Imp.html#X"><span class="id" type="definition">X</span></a> = <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Smallstep.html#CImp.par_body_n"><span class="id" type="axiom">par_body_n</span></a> <span class="id" type="var">n</span> <a class="idref" href="Imp.html#empty_state"><span class="id" type="definition">empty_state</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">update</span>; <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rename</span> <span class="id" type="var">x</span> <span class="id" type="var">into</span> <span class="id" type="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H'</span> [<span class="id" type="var">HX</span> <span class="id" type="var">HY</span>]].<br/>
&nbsp;&nbsp;<span style="font-family: arial;">&exist;</span> (<a class="idref" href="Imp.html#update"><span class="id" type="definition">update</span></a> <span class="id" type="var">st</span> <a class="idref" href="Imp.html#Y"><span class="id" type="definition">Y</span></a> 1). <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_trans"><span class="id" type="axiom">rsc_trans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="Smallstep.html#CImp.par_loop"><span class="id" type="definition">par_loop</span></a>,<span class="id" type="var">st</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par1"><span class="id" type="constructor">CS_Par1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Ass"><span class="id" type="constructor">CS_Ass</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_While"><span class="id" type="constructor">CS_While</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq1"><span class="id" type="constructor">BS_Eq1</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.AS_Id"><span class="id" type="constructor">AS_Id</span></a>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Imp.html#update_eq"><span class="id" type="axiom">update_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfStep"><span class="id" type="constructor">CS_IfStep</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.BS_Eq"><span class="id" type="constructor">BS_Eq</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_Par2"><span class="id" type="constructor">CS_Par2</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_IfFalse"><span class="id" type="constructor">CS_IfFalse</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="SfLib.html#rsc_step"><span class="id" type="constructor">rsc_step</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#CImp.CS_ParDone"><span class="id" type="constructor">CS_ParDone</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#rsc_refl"><span class="id" type="constructor">rsc_refl</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Imp.html#update_neq"><span class="id" type="axiom">update_neq</span></a>. <span class="id" type="tactic">assumption</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Smallstep.html#"><span class="id" type="module">CImp</span></a>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>